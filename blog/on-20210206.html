<!DOCTYPE html><html lang="ja"><head><title>色(v9.18.0)</title><p><time>2021-02-06</time></p><h1>色(v9.18.0)</h1>

<p>ついにGoogleが、検索結果ページで暗い背景を試し始めたようなので、ふたたび真っ黒の背景色でダーク・モードを仕込んでおいた。切り替え機能は次のバージョンで再導入される。他に、色を1つ減らしたり、ページ・ヘッダーなどでも未読リンクが判別できるようにしたり、構文強調のカラー・スキームを脱Solarizedしたりした。色関係で変更が多い。</p>

<p>新しいコントラストのスコア化アルゴリズム(Advanced Perceptual Contrast Algorithm: APCA)がちらほら話題になっている。うまく機能しているように見えるし、今までのコントラスト比計算における問題点が改善されているように感じる。まずは<a href="https://github.com/Myndex/SAPC-APCA#apca-math-new-098d12e-constants">この新しいアルゴリズムの実装の解説</a>(英語の解説と、LaTeXの数式、JavaScriptの実装で微妙に食い違いがあった)を読みながら<a href="https://gist.github.com/hail2u/a1fb620d4826c5b476180ee6285618a5">コード</a>に落とし、<a href="/style-guide/#color">スタイル・ガイドの色彩</a>などで、コントラスト・スコアを確認するために使い始めた。ついでに、2色のコントラスト・スコアを簡単にチェックできる、<a href="/pub/test/702.html">APCA Contrast Calculator</a>というページも作った。</p>

<section>
<h2>APCAについてのメモ</h2>

<p>SAPC(S-Luv Advanced Perceptual Contrast)がコントラストそのもので、APCAがそれを元に重み付けし、スコア化(以前はパーセンテージだった)するアルゴリズムのようだ。SAPCについてはあまり考えなくていいだろう。</p>

<ul>
<li>LaTeX数式を元に、英語の解説や、JavaScriptライブラリーが作られている</li>
<li>明度を計算する仕組みそのものはあまり変わっていない</li>
<li>前景色と背景色を扱い分けるので、前景色と背景色を入れ替えるとコントラストが変わる</li>
<li>コントラストに対し重みづけをし、知覚的な印象に近づける</li>
<li>まだ色覚多様性は考慮されていない</li>
<li>比率やパーセンテージではなく、スコア化する</li>
<li>|80|が7:1、|60|が4.5:1、|40|が3:1に相当するように結果はスコア化される</li>
</ul>

<p>知覚的なコントラストのため、色覚多様性での差異が激しくなるのではないか、という疑問は解決しなかった。コントラストを算出するための色空間モデルのレベルで、元々考慮しているというようにも読めるため、あまり気にする必要はないかもしれない。素直にWCAG 2.1のコントラスト・アルゴリズムも併用するべきだろう。</p>
</section>

<hr>

<p>他には、ハンバーガー・ボタンがなくなった。そのためマイナー番号が上がっている。ハンバーガー・ボタンは気に入ってはいたものの、やはりこのようなウェブサイトでわざわざボタンを押させるのはよくない。<code>details</code>要素での作り方はだいたいわかったので、またどこかで使いたい。</p>
