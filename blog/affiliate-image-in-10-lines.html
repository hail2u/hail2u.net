<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="light dark" name="color-scheme">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>10行分のアフィリエイト画像</title>

    <style>
      body {
        font-family: sans-serif;
        font-size: 112.5%;
        margin-block-end: 25svh;
      }

      pre {
        white-space: pre-wrap;
      }

      figure {
        margin-inline: 0;
      }

      img,
      svg {
        block-size: auto;
        max-inline-size: 100%;
      }
    </style>
  </head>

  <body>
    <p><time>2020-08-07</time></p>

    <h1>10行分のアフィリエイト画像</h1>

    <p><a href="/blog/amazon-basics-yoga-mat.html">少し前の記事</a>は久々のアフィリエイト記事だった。以前はアフィリエイト画像を<code>float</code>プロパティーで右に寄せていたが、今は幅いっぱいに10行分の高さで表示されるようになっている。右に寄せると狭い画面で更に本文が狭くなるし、狭い画面で狭くならないようにするには複雑なCSSコードを書く羽目になるので、こういう形に落ち着いた。</p>

<p>右(や左)に寄せない場合、画像の縦横比を維持して幅いっぱいにするか、あまり考えずに自然の解像度のまま表示するかになる。前者の場合、縦長の画像で本文がかなり下の方へ追いやられてしまう。一方、後者の場合は画像の縦横比によってどのような表示になるか読めなくなってしまう(1:10の縦横比だったりすることもある)。そこで幅いっぱいにはするものの、縦方向の長さを固定することにした。</p>

<p>高さを10行分に固定するには<code>calc()</code>関数を使う。フォント・サイズと行の高さを掛け、10倍すればいい。</p>

<pre><code class="language-css">:root {
  --font-size-default: 1rem;
  --line-height-default: 1.5;
}

.affiliate {
  height: calc(var(--font-size-default) * var(--line-height-default) * 10);
}</code></pre>

<p>この設定だと<code>15rem</code>になる。ユーザーのズームやユーザーのフォント・サイズ変更、もし利用しているならレスポンシブ・フォント・サイズに応じて、実際の大きさは変わるだろう。</p>

<p>画像のサイズ変更は、元画像が縦長か横長かわからないので、とりあえず幅と高さをいっぱいいっぱいにして、<code>object-fit: contain</code>で縦横比を考慮してもらう。</p>

<pre><code class="language-css">.affiliate img {
  height: 100%;
  object-fit: contain;
  width: 100%;
}</code></pre>

<p>このようにすると、親要素の上下左右の中央に配置される。そのため縦長でも横長でも中央に寄せられるので、どちらもそれなりにすっきりと見える。縦長では大きくなりすぎることがなくなり、横長では詰まりすぎることがなくなるわけだ。<code>object-fit</code>プロパティーは大きさを変えるのではなく、大きさが変化したものを調整する性格が強いことは忘れないようにしたい。</p>

<hr>

<p>ついでに<code>mix-blend-mode: multiply</code>にして、背景色となじませるようにもした。画像の色が暗くなるので好きな手法ではないが、真っ白で幅いっぱいにしてしまうと、ちょっと辛そうだったため、乗算で妥協した。<code>filter: contrast(1.2)</code>と組み合わせてもいいかもしれない。</p>
  </body>
</html>
