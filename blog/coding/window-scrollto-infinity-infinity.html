<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="light dark" name="color-scheme">
    <meta content="width=device-width" name="viewport">

    <title>window.scrollTo(Infinity, Infinity)</title>

    <link title="ウェブサイト全体のRSS" href="/feed" rel="alternate" type="application/rss+xml">
    <link title="記事だけのRSS" href="/blog/feed" rel="alternate" type="application/rss+xml">
    
    
    
    <link href="/apple-touch-icon.png" rel="apple-touch-icon">
    <link href="mailto:hail2u@gmail.com" rel="author">
    <link href="https://hail2u.net/blog/coding/window-scrollto-infinity-infinity.html" rel="canonical">
    <meta content="絶対的なスクロールはwindow.scrollTo()で、相対的なスクロールはwindow.scrollBy()で可能だ。このあたりのことを決めているCSSOM View Moduleではwindow.scroll()のショートカットとしてscrollTo()が決められていたりするが、大抵はこのどちらかで行うことになる。しかしページ最下部への移動をちゃんと行うとなると、色々面倒くさい(スクロール・バーとか)。そのためありえないくらいの大きな値を渡して誤魔化すことが多かったが、それならとInifityを渡したらChrome 42やInternet Explorer 11ではうまく動いた。" name="description">
    <link href="/favicon.svg" rel="icon" type="image/svg+xml">
    <link href="https://creativecommons.org/licenses/by/4.0/" rel="license">
    <link href="https://duckduckgo.com/?q=site%3Ahail2u.net" rel="search">

    <link href="/css/print.css?v=9.33.1" media="only print" rel="stylesheet">
    <link href="/css/index.css?v=9.33.1" media="only screen" rel="stylesheet">
  </head>

  <body>

      <nav id="top">
        <p class="logo"><a href="/"><span aria-label="ホームへ戻る">←</span></a></p>
      </nav>

      <header class="page-header">
          <p class="date"><time datetime="2015-05-16T06:57:52+09:00">2015年5月16日</time></p>

        <h1><em>window.scrollTo(Infinity, Infinity)</em></h1>
      </header>

    <main>
      <p>絶対的なスクロールは<code>window.scrollTo()</code>で、相対的なスクロールは<code>window.scrollBy()</code>で可能だ。<a href="http://www.w3.org/TR/cssom-view/">このあたりのことを決めているCSSOM View Module</a>では<code>window.scroll()</code>のショートカットとして<code>scrollTo()</code>が決められていたりするが、大抵はこのどちらかで行うことになる。しかしページ最下部への移動をちゃんと行うとなると、色々面倒くさい(スクロール・バーとか)。そのためありえないくらいの大きな値を渡して誤魔化すことが多かったが、それならと<code>Inifity</code>を渡したらChrome 42やInternet Explorer 11ではうまく動いた。</p>

<p>Demo: <a href="/test/629.html">window.scrollTo(Infinity, Infinity)</a></p>

<p>デモでは右と下の端までスクロールさせるボタンが三種類ある。もちろんX座標とY座標のどちらかだけ<code>Infinity</code>を指定してもそのどちらかの端までスクロールさせることができるということだ。どれもChrome 42とInternet Explorer 11ではスクロールされるが、Firefox 37と(Mobile )Safari 8ではそのようにはスクロールされず、ページの先頭に戻される。</p>

<p>どうやらFirefox 37とSafari 8の挙動が正しいようだ。<a href="http://dev.w3.org/csswg/cssom-view/">2015/04/20版の開発中の仕様</a>では以下のように定義されている。</p>

<blockquote>
<p>void scroll(unrestricted double x, unrestricted double y);</p>
</blockquote>

<p>Web IDLによると<a href="http://www.w3.org/TR/WebIDL/#float-token-value">unrestricted double</a>は正負のInfinity (やNaN)を許容するので、<code>window.scrollTo(Infinity, Infinity)</code>としても間違いではないということになる。しかし同時に<a href="http://dev.w3.org/csswg/cssom-view/#webidl-values">non-finite valueを0とすると</a>も決められているので、<code>window.scrollTo(0, 0)</code>と解釈されるべきということになる。</p>

<p>一方、<a href="http://www.w3.org/TR/2013/WD-cssom-view-20131217/">最新のWD</a>では<code>double</code>となっており、<code>Infinity</code>は許容されない(「<code>Infinity</code>, <code>-Infinity</code> and <code>NaN</code> <em>must not</em> be used as the value of a float or double」)。そのためChrome 42やInternet Explorer 11の挙動はどちらの仕様をとったとしてもバグだと言える。Chromeでは<a href="https://code.google.com/p/chromium/issues/detail?id=456670">バグ</a>が立っており、既に修正されたようだ。Internet Explorerにはバグ報告はしておいた。</p>

<hr>

<p><code>Infinity</code>で書けるとわかりやすそうかなと思ったが、そうはうまくいかなかった。結局<code>window.scrollTo(99999999, 99999999)</code>とか書き続けることになるようだ。</p>
    </main>

    <footer class="page-footer">
      <hr>

        <p>このウェブサイトは<a href="mailto:hail2u@gmail.com">ながしまきょう</a>が<a title="Creative Commons (表示)" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a>の下で作成、公開、そして更新しています。更新情報は<a href="/feed" type="application/rss+xml">RSS</a> (<a href="/blog/feed" type="application/rss+xml">記事だけのRSS</a>)または<a href="https://x.com/hail2u_">X</a>で購読できます。その他、わからないことは<a href="https://hail2u.net/about/">もう少し詳しい情報</a>を参照してください。</p>

      <p><a href="#top"><span aria-hidden="true">↑ </span>一番上</a></p>
    </footer>
  </body>
</html>
