<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">

    <title>Sassで文字列の置換を行うユーザー定義関数</title>

    <link title="ウェブサイト全体のRSS" href="/feed" rel="alternate" type="application/rss+xml">
    
    <link title="雑多な記録だけのRSS" href="/blog/feed" rel="alternate" type="application/rss+xml">
    
    
    <link href="/apple-touch-icon.png" rel="apple-touch-icon">
    <link href="mailto:hail2u@gmail.com" rel="author me">
    <link href="https://hail2u.net/blog/coding/sass-str-replace-function.html" rel="canonical">
    <meta content="light dark" name="color-scheme">
    <meta content="Sass 3.3で入る予定の文字列関数の使い道を色々考えているけど、まったく「これは！」みたいなのが思いつかない。なので、実際に利用しがいがあるかどうかは置いておいて、色々作ってみようかなと考えている。まずは文字列の置換。" name="description">
    <link href="/" rel="home">
    <link href="/favicon.svg" rel="icon" type="image/svg+xml">
    <link href="/blog/" rel="index">
    <link href="https://creativecommons.org/licenses/by/4.0/" rel="license">
    <link href="https://github.com/hail2u" rel="me">
    <link href="https://x.com/hail2u_" rel="me">
    <link href="https://duckduckgo.com/?q=site%3Ahail2u.net" rel="search">
    <meta content="width=device-width" name="viewport">

    <link href="/css/print.css?v=9.32.0" media="only print" rel="stylesheet">
    <link href="/css/index.css?v=9.32.0" media="only screen" rel="stylesheet">

    <meta content="summary" name="twitter:card">
    <meta content="Sass 3.3で入る予定の文字列関数の使い道を色々考えているけど、まったく「これは！」みたいなのが思いつかない。なので、実際に利用しがいがあるかどうかは置いておいて、色々作ってみようかなと考えている。まずは文字列の置換。" property="twitter:description">
    
    <meta content="@hail2u_" name="twitter:site">
    <meta content="Sassで文字列の置換を行うユーザー定義関数" property="twitter:title">
  </head>

  <body>

      <nav id="top">
        <p class="logo"><a href="/"><svg viewBox="0 0 16 16" role="img" aria-labelledby="logo-title"><title id="logo-title">ホームへ戻る</title><path d="m 2,7 3,7 h 7 L 14,9 13,4 9,2 Z"/></svg></a></p>
      </nav>

      <header class="page-header">
          <p class="date"><time datetime="2013-08-16T17:19:11+09:00">2013年8月16日</time></p>

        <h1><em>Sassで文字列の置換を行うユーザー定義関数</em></h1>
      </header>

    <main>

    <p><a href="https://github.com/nex3/sass/blob/0ef77dc0e3cff821aadca09aca98cac46354093d/lib/sass/script/value/string.rb">Sass 3.3で入る予定の文字列関数</a>の使い道を色々考えているけど、まったく「これは！」みたいなのが思いつかない。なので、実際に利用しがいがあるかどうかは置いておいて、色々作ってみようかなと考えている。まずは文字列の置換。</p>

<pre><code class="language-scss">// str-replace() - Replace in a string
//
// @param {string}  $string    String that you want to replace
// @param {string}  $substr    String that is to be replaced by `$newsubstr`
// @param {string}  $newsubstr String that replaces `$substr`
// @param {number*} $all       Flag for replacing all (1+) or not (0)
// @return {string}
@function str-replace($string, $substr, $newsubstr, $all: 0) {
  $position-found: str-index($string, $substr);
  $processed: ();

  @while ($position-found &gt; 0) {
    $length-substr: str-length($substr);
    $processed: append($processed, str-slice($string, 0, $position-found - 1));
    $processed: append($processed, $newsubstr);
    $string: str-slice($string, $position-found + $length-substr);
    $position-found: 0;

    @if ($all &gt; 0) {
      $position-found: str-index($string, $substr);
    }
  }

  $processed: append($processed, $string);
  $string: &quot;&quot;;

  @each $s in $processed {
    $string: #{$string}#{$s};
  }

  @return $string;
}</code></pre>

<p><code>str-index()</code>で置換対象文字列<code>$substr</code>見つけたら、<code>$substr</code>までを抜き出したのと置換後文字列<code>$newstr</code>をリストである<code>$processed</code>に追加していくという作業を行うだけ。最後に<code>$processed</code>を連結して返す。<code>$all</code>は全置換を行うかどうかのフラグで、<code>0</code>か省略した場合は最初の１つだけ置換する。</p>

<pre><code class="language-scss">.test {
  margin: str-replace(&quot;1em 2em&quot;, &quot;em&quot;, &quot;rem&quot;, 1);
}</code></pre>

<p>と書くと、</p>

<pre><code class="language-css">.test {
  margin: 1rem 2rem; }</code></pre>

<p>となる。この利用例にまったく意味はない。</p>

<hr>

<p>こういう<a href="https://github.com/hail2u/scss-functions">汎用的であることを意識したユーザー定義関数</a>を作っておいて<code>@import</code>するというのもそれほど悪くはなさそう。しかし、ミックスインのように即戦力ではないので、別に分けて管理してもメリットを得る機会はほとんどなさそう。かといって毎回一から書くのでは面倒臭いので、コアの部分をコード・スニペットとしてどっかに置いといて、複雑な特化型ユーザー定義関数を書く時に引っ張り出してきて使うというのが理にかなっている。と感じた。</p>

    </main>

    <footer class="page-footer">
        <nav>
          <p><a href="/blog/"><span aria-hidden="true">⬑ </span>雑多な記録の一覧</a></p>
        </nav>

      <p><a title="Creative Commons (表示)" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a> · <a href="mailto:hail2u@gmail.com">ながしまきょう / hail2u</a> (<a href="https://x.com/hail2u_">X</a> · <a href="https://github.com/hail2u">GitHub</a>)</p>

      <p><a href="/feed" type="application/rss+xml">RSS</a> (<a href="/blog/feed" type="application/rss+xml">雑多な記録だけのRSS</a>)</p>

      <p><a href="#top"><span aria-hidden="true">↑ </span>一番上</a></p>
    </footer>
  </body>
</html>
