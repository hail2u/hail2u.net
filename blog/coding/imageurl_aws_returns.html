<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>AWSが返すImageUrl</title>

    <style>
      body {
        font-family: sans-serif;
        font-size: 112.5%;
        margin-block-end: 25svh;
      }

      pre {
        white-space: pre-wrap;
      }

      figure {
        margin-inline: 0;
      }

      img,
      svg {
        block-size: auto;
        max-inline-size: 100%;
      }
    </style>
  </head>

  <body>
    <p><time>2004-03-31</time></p>

    <h1>AWSが返すImageUrl</h1>

    <p><a href="https://www.amazon.co.jp/exec/obidos/redirect?tag=hail2unet-22&amp;path=subst/associates/join/webservices.html" title="Amazon Webサービス">AWS</a>を利用して<a href="https://www.amazon.co.jp/" title="Amazon.co.jp: アマゾンへようこそ！　">Amazon.co.jp</a>で検索すると、輸入版のCDもヒットします。その時、<code>Detail</code>以下の<code>ImageUrlMedium</code>などに入るURLがどうもおかしいですね。</p>
<p>入っているURLは、</p>
<pre>https://m.media-amazon.com/images/P/B00006879E.jpg</pre>
<p>というようにASINに続いて&quot;09&quot;なんですが、実際は</p>
<pre>https://m.media-amazon.com/images/P/B00006879E.jpg</pre>
<p>というようにASINに続いて&quot;01&quot;とかいう。経験から日本の製品は&quot;09&quot;、輸入物は&quot;01&quot;らしいとかいうのが頭にあったので気づいたのですが。</p>
<p>うーん、プログラム側で対処する問題なのだろうか。とは言うものの、Amazon.co.jpで普通に検索する時出てくる「Import」とか「From US」など輸入版かどうか判断できる文字列が無いし、判断できそうもない。</p>
<p>とりあえずDiscussion Boardに投稿してみたり。</p>
<section>
<h2>追記</h2>
<p>FAQにある罠。</p>
</section>
<section>
<h2>追記</h2>
<p><code>head</code>リクエストで帰ってきたContent-Lengthヘッダの値が807だったら、黒い1*1の画像のようですね。ゴニョゴニョいじったらうまいこと出来ました。</p>
</section>
  </body>
</html>
