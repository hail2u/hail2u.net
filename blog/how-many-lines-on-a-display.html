<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>画面に何行入るか</title>

    <link title="ウェブサイト全体のRSS" href="/feed" rel="alternate" type="application/rss+xml">
    <link title="記事だけのRSS" href="/blog/feed" rel="alternate" type="application/rss+xml">
    
    
    
    <link href="mailto:hail2u@gmail.com" rel="author">
    <link href="https://hail2u.net/blog/how-many-lines-on-a-display.html" rel="canonical">
    <meta content="文字の大きさの決定方法にはいくつかあるが、ウェブページにおいては画面の横幅を基準に行うことが多い。紙媒体での伝統を踏まえたものだ。縦横比の種類が限られ、画面の横幅から画面の大きさが推測できた時代はそれで良いが、折りたたみスマートフォンやヘッドマウンテッド・ディスプレイなども含め、多様化どころではない時代にはそぐわないように思う。どうせ横幅には制限をかけるだろうから、縦幅にどれくらい流し込むか、つまり画面に何行入るかで文字の大きさを決めたらどうだろうか。" name="description">
    <link href="/favicon.svg" rel="icon" type="image/svg+xml">
    <link href="https://creativecommons.org/licenses/by/4.0/" rel="license">
    <link href="https://m.media-amazon.com/" rel="preconnect">
    <link href="https://duckduckgo.com/?q=site%3Ahail2u.net" rel="search">

    <link href="/css/print.css?v=9.34.5" media="only print" rel="stylesheet">
    <link href="/css/index.css?v=9.34.5" media="only screen" rel="stylesheet">
  </head>

  <body>

      <nav id="top">
        <p class="logo"><a href="/"><span role="img" aria-label="ホームへ戻る">←</span></a></p>
      </nav>

      <header class="page-header">
          <p class="date"><time datetime="2025-02-27T11:33:12+09:00">2025年2月27日</time></p>

        <h1><em>画面に何行入るか</em></h1>
      </header>

    <main>
      <p>文字の大きさの決定方法にはいくつかあるが、ウェブページにおいては画面の横幅を基準に行うことが多い。紙媒体での伝統を踏まえたものだ。縦横比の種類が限られ、画面の横幅から画面の大きさが推測できた時代はそれで良いが、折りたたみスマートフォンやヘッドマウンテッド・ディスプレイなども含め、多様化どころではない時代にはそぐわないように思う。どうせ横幅には制限をかけるだろうから、縦幅にどれくらい流し込むか、つまり画面に何行入るかで文字の大きさを決めたらどうだろうか。</p>

<p>例えば行送りが1.5の30行とすると、縦幅1080ピクセルの画面では以下のように計算できる。30という数字は手元にあった<em>判型が特殊な</em>横書きの本から借用する。また、1080ピクセルという数字はフルHDのディスプレイの解像度から借用する。</p>

<pre>1080px / (1.5 * 30) = 24px</pre>

<p>大きめの画面で大きめの文字サイズということになり、直観的には悪くなさそうな雰囲気がある。縦幅が100ピクセル増えると、文字サイズが<code>2.222px</code>大きくなる計算だ。4Kディスプレイなら縦1920ピクセルなので、<code>42.667px</code>になる。実際にはブラウザーのGUI領域などでもう少し小さいだろう。CSSでは描画領域の高さを<code>*vh</code>単位で参照できるので、以下のように書ける。最低でもこれくらい入るという観点で決めたいので、<code>svh</code>単位にしたい。</p>

<pre><code>:root {
  font-size: calc(<mark>100svh / (1.5 * 30)</mark>);
}</code></pre>

<p>このままではユーザー設定の文字サイズよりも小さくなる可能性がある。スマートフォンを横向きで使う時はそうなってしまうだろう。下限はユーザーの文字サイズ設定を尊重しなければならない。上限が難しいところだが、<code>48px</code>とし、4Kディスプレイでも到達しないくらいにしておく。<code>calc</code>関数を<code>clamp</code>関数に変え、最小値で<code>%</code>を、最大値で<code>px</code>単位を使う。</p>

<pre><code>:root {
  font-size: clamp(<mark>100%</mark>, 100svh / (1.5 * 30), <mark>48px</mark>);
}</code></pre>

<p>最近のスマートフォンなど、縦横比が2:1を超えるような縦長の機器では大きくなりすぎる懸念がある。縦長の機器では紙媒体と挙動が似ていると考えられるので、1行の文字数、つまり列数を固定してみたい。列数は、余白を考慮すると1行の文字数が35文字から38文字(<a href="https://en.wikipedia.org/wiki/Line_length">半角英数字で70文字から75文字</a>)くらいとなる40文字としてみる。これを<code>min</code>関数を使って、うまく切り替わるようにする。</p>

<pre><code>:root {
  font-size: clamp(
    100%,
    <mark>min(
      100svh / (1.5 * 30),
      100svw / 40
    )</mark>,
    48px
  );
}</code></pre>

<p>これで行数と列数の両方で収まりが良いと考えられる大きさになる。描画領域に対する文章の圧(表現が難しいが、埋まり具合とか密度とか、そのような感覚のこと)が一定になるだろう。行数と列数は厳密なものではないので、それらの平均を取って<code>svmin</code>単位を割ることで<code>min</code>関数の計算結果に近い値を出しても良いかもしれない。</p>

<pre><code>:root {
  font-size: clamp(
    100%,
    <mark>100svmin / ((1.5 * 30 + 40) / 2)</mark>,
    48px
  );
}</code></pre>

<p>テキトウに横幅に応じて大きくしていくよりは論理的だが、複雑性がかなり残る。ユーザーが設定した文字の大きさを優先しつつ、なるべく収まりの良い大きさを提供するという手法を具現化しただけなので、まだまだ手を入れるべきところはあるだろう。他の手法も考えつつ研ぎ澄ませたい。</p>

<hr>

<pre><code>:root {
  --ratio: calc(pow(3, 2) / pow(2, 3));
  --line-height-default: calc(pow(var(--ratio), 4));
  --ratio-column: calc(pow(var(--ratio), 32));

  font-size: max(
    100%,
    min(
      100svh / (var(--line-height-default) * 28),
      100svw / var(--ratio-column),
      24px
    )
  );
}</code></pre>

<p>手元ではこのような実装にしてみている。<code>max</code>関数で<code>100%</code>とその他に分けることで、ユーザー設定を優先することを明示的にする。実際の調整は<code>min</code>関数の方へ閉じ込め、マジック・ナンバーも極力使わないように気を付ける。<code>--line-height-default</code>という変数を28倍にして、高さを割るなら、画面に28行収まる文字の大きさになると推察できるはずだ。また、最大サイズも<code>24px</code>と控えめなものにした。タブレット端末のようなそこそこ大きい上に縦横比が正方形に近づく端末で、やや大きくなる傾向があるからだ。</p>
    </main>

    <footer class="page-footer">
        <p>このウェブサイトは<a href="mailto:hail2u@gmail.com">ながしまきょう</a>が<a title="Creative Commons (表示)" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a>の下で作成、公開、そして更新しています。更新情報は<a href="/feed" type="application/rss+xml">RSS</a> (<a href="/blog/feed" type="application/rss+xml">記事だけのRSS</a>)または<a href="https://x.com/hail2u_">X</a>で購読できます。その他、わからないことは<a href="/#about">もう少し詳しい情報</a>を参照してください。</p>

      <p><a href="#top"><span aria-hidden="true">↑ </span>一番上</a></p>
    </footer>
  </body>
</html>
