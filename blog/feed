<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
  xml:lang="ja"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:creativeCommons="http://backend.userland.com/creativeCommonsRssModule">
  <channel>
    <description>ウェブ開発に関する話題が中心でしたが、もはやそれに限らず備忘録に近いものです。</description>
    <link>https://hail2u.net/blog/</link>
    <managingEditor>hail2u@gmail.com (Kyo Nagashima)</managingEditor>
    <title>雑多な記録 - Hail2u</title>
    <atom:link href="https://hail2u.net/blog/feed" rel="self" type="application/rss+xml"/>
    <creativeCommons:license>https://creativecommons.org/licenses/by/4.0/</creativeCommons:license>

      <item>
        <description><![CDATA[展覧会の前後はいつもの通り散歩だが、今回は特にどこにも寄らずただ歩く。15度を超える気温で、雲も風もなく、快適な一日だ。シャツと春用のコートだけだったが、それでも暑く感じる。何もしていない散歩なので、ただ写真を並べる。]]></description>
        <guid>https://hail2u.net/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman.html</guid>
        <link>https://hail2u.net/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman.html</link>
        <pubDate>Fri, 7 Mar 2025 11:38:10 +0900</pubDate>
        <title><![CDATA[丸の内～銀座～新橋、南青山～原宿～代々木八幡]]></title>
        <content:encoded><![CDATA[<figure>
<picture>
<source srcset="/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman.avif" type="image/avif">
<img alt="ゆるやかにカーブした石造りのベンチが並ぶ中庭の奥に、レンガ造りの建物がある。その入り口は、保存のためか大きく鉄骨とガラスで覆われている上、美術館として使われているため、展覧会の案内ポスターによりほとんど隠れてしまっている。" height="1440" src="https://hail2u.net/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman.jpg" width="2560">
</picture>
</figure>

<p>展覧会の前後はいつもの通り散歩だが、今回は特にどこにも寄らずただ歩く。15度を超える気温で、雲も風もなく、快適な一日だ。シャツと春用のコートだけだったが、それでも暑く感じる。何もしていない散歩なので、ただ写真を並べる。</p>

<figure>
<picture>
<source srcset="/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-double-bridge-drawing.avif" type="image/avif">
<img alt="縦8cm、横15cmくらいの白いタイルが一面に張られた壁面に、二重橋をモチーフにした線画が大きく走っている。" height="1440" src="https://hail2u.net/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-double-bridge-drawing.jpg" width="2560">
</picture>
<figcaption>二重橋前駅の壁</figcaption>
</figure>

<figure>
<picture>
<source srcset="/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-sony-park.avif" type="image/avif">
<img alt="広い道路の向こう側に、銀座周辺では珍しい低層の建物が建っている。建物は打ちっ放しのコンクリートで、その周囲を白い格子状の鉄骨が覆っている。" height="1440" src="https://hail2u.net/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-sony-park.jpg" width="2560">
</picture>
<figcaption>ソニー・パーク</figcaption>
</figure>

<figure>
<picture>
<source srcset="/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-under-bridge.avif" type="image/avif">
<img alt="高架を支える緑の鉄骨製構造体は、縦方向にのみ黄色と黒で斜めに塗り分けられている。鉄骨には様々なステッカーがびっしりと貼られており、中には東京都生活文化局の警告テープも見られる。" height="1440" src="https://hail2u.net/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-under-bridge.jpg" width="2560">
</picture>
<figcaption>高架下</figcaption>
</figure>

<figure>
<picture>
<source srcset="/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-bicycle-parking.avif" type="image/avif">
<img alt="大きく育った木々の間を縫うように駐輪場が作られ、多くのバイクが停められている。" height="1440" src="https://hail2u.net/img/blog/marunouchi-ginza-shinbashi-minami-aoyama-harajuku-yoyogi-hachiman-bicycle-parking.jpg" width="2560">
</picture>
<figcaption>駐輪場</figcaption>
</figure>

<p>ソニー・パークの感想を書きたい気持ちが少しあるが、中の催し物をきちんと見た時に改めて書きたい。屋上は見たし、屋上からも見た。Afeelaも見た。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[描画領域の大きさを参照する単位は、当初vwとvh単位しかなかった。その後、Mobile Safariを皮切りに動的な描画領域を持つブラウザーが増えたことから、暗黙的に描画領域の最大値を参照する値となっている。lvwとlvh単位は明示的に同じ値を参照するので、これらの方が第三者にわかりやすいコードになるはずだ。実装は2022年頃に揃っている。]]></description>
        <guid>https://hail2u.net/blog/moving-to-lvw-and-lvh-units.html</guid>
        <link>https://hail2u.net/blog/moving-to-lvw-and-lvh-units.html</link>
        <pubDate>Thu, 6 Mar 2025 12:11:35 +0900</pubDate>
        <title><![CDATA[lvw/lvh単位へ]]></title>
        <content:encoded><![CDATA[<p>描画領域の大きさを参照する単位は、当初<code>vw</code>と<code>vh</code>単位しかなかった。その後、Mobile Safariを皮切りに動的な描画領域を持つブラウザーが増えたことから、暗黙的に描画領域の最大値を参照する値となっている。<code>lvw</code>と<code>lvh</code>単位は明示的に同じ値を参照するので、これらの方が第三者にわかりやすいコードになるはずだ。実装は2022年頃に揃っている。</p>

<p>描画領域関連の単位は、幅と高さの小さい方の最大値を参照する<code>lvmin</code>単位から、ブラウザーが動的に制御する高さと同期する<code>dvh</code>単位まで、様々な単位が定義されている。viewportを示す「v」に、「l」と「s」と「d」という接頭辞、「w (i)」と「h (b)」と「min」と「max」という接尾辞、これらの組み合わせによってどういう単位か明確になるというわけだ。接頭辞が無い場合は<a href="https://www.w3.org/TR/2024/WD-css-values-4-20240312/#viewport-variants">暗黙的にlとみなされるという定義</a>になっているが、互換性のために残されていると言って良さそうな雰囲気が仕様の文から伝わってくる。</p>

<p>ゆくゆくは書字方向に依存しない<code>*vi</code>や<code>*vb</code>単位へと置き換えてゆくべきかもしれない。しかし、メンタル・モデルの更新なので、同時に行うと混乱しやすい。まずは<code>lv*</code>に置き換え、それに慣れたら次の更新を考えれば良いだろう。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[自前のスクリプトで管理していた音楽アルバムの新規リリース監視を諦め、Muspyに出戻る。自前ではMusicBrainzを週に1回くらいクロールしていた。ログインせずに使えて便利ではあるものの、フィード・リーダーで見れた方が楽かもしれないと、過去に半年くらい利用していたMuspyに出戻ることにした。]]></description>
        <guid>https://hail2u.net/blog/back-to-muspy.html</guid>
        <link>https://hail2u.net/blog/back-to-muspy.html</link>
        <pubDate>Wed, 5 Mar 2025 13:33:31 +0900</pubDate>
        <title><![CDATA[Muspyに復帰]]></title>
        <content:encoded><![CDATA[<p>自前のスクリプトで管理していた音楽アルバムの新規リリース監視を諦め、<a href="https://muspy.com/">Muspy</a>に出戻る。自前では<a href="https://musicbrainz.org/">MusicBrainz</a>を週に1回くらいクロールしていた。ログインせずに使えて便利ではあるものの、フィード・リーダーで見れた方が楽かもしれないと、過去に<a href="https://hail2u.net/blog/muspy.html">半年くらい利用していたMuspy</a>に出戻ることにした。</p>

<p>うまいこと使えているかどうかはわからないが、今もRSSやiCalの情報は正しいようだ。アーティスト名の追加が面倒そうだったが、追加するフォームにカンマ区切りで入力すれば一気にインポートできることを知る。同じ名前で複数のアーティストがいるような場合に、手作業で修正しないとならなかったが、5つくらいで済んだので、大した手間ではない。こういうやつのマンガ版が欲しいところだ。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[たまに「準備中です」のままWindows Helloの顔認証が進まないことがある。どうにもならないのでPINでログインすると、Microsoft Streaming Service Proxyというデバイスがエラーを出していることが多い。これを無効化して、再度有効化するとエラーと共にデバイスが消え、無事Helloできるようになる。]]></description>
        <guid>https://hail2u.net/blog/2025-03-04.html</guid>
        <link>https://hail2u.net/blog/2025-03-04.html</link>
        <pubDate>Tue, 4 Mar 2025 11:17:17 +0900</pubDate>
        <title><![CDATA[Windows Helloできない状態の修正]]></title>
        <content:encoded><![CDATA[<p>たまに「準備中です」のままWindows Helloの顔認証が進まないことがある。どうにもならないのでPINでログインすると、Microsoft Streaming Service Proxyというデバイスがエラーを出していることが多い。これを無効化して、再度有効化するとエラーと共にデバイスが消え、無事Helloできるようになる。</p>

<p>最初はいちいち再起動していたが、調子の悪いバッテリーを調べていた時に、このデバイスがエラーを出していることを知った。その時にちょうどWindows Helloに失敗していたので、これをどうにかするだけで直ることに気付けた。理由はよくわかっていないし、あまり調べてもいない。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[アール・ヌーヴォーで重要な人物の一人、オーブリー・ピアズリーの展覧会を見に行く。ピアズリーについては名前といくつかの絵くらいしか知らないが、好きな画風ではあるので楽しみだ。開館前から行列で、やや出鼻を挫かれる。]]></description>
        <guid>https://hail2u.net/blog/beardsley-a-singular-prodigy-2025-02-28.html</guid>
        <link>https://hail2u.net/blog/beardsley-a-singular-prodigy-2025-02-28.html</link>
        <pubDate>Mon, 3 Mar 2025 10:39:56 +0900</pubDate>
        <title><![CDATA[異端の奇才・ピアズリー展(三菱一号館美術館)]]></title>
        <content:encoded><![CDATA[<figure>
<picture>
<source srcset="/img/blog/beardsley-a-singular-prodigy-2025-02-28.avif" type="image/avif">
<img alt="大振りの石造りの柱とレンガの壁で構成された美術館の建物を囲むように、黒い鉄柵と展覧会のポスターや美術館の案内の掲示板が並ぶ。掲示板の左脇からは美術館へ入る階段が見え、右側の鉄柵の奥には凝った意匠の換気孔も見える。" height="1440" src="https://hail2u.net/img/blog/beardsley-a-singular-prodigy-2025-02-28.jpg" width="2560">
</picture>
</figure>

<p>アール・ヌーヴォーで重要な人物の一人、<a href="https://mimt.jp/ex/beardsley/">オーブリー・ピアズリーの展覧会</a>を見に行く。ピアズリーについては名前といくつかの絵くらいしか知らないが、好きな画風ではあるので楽しみだ。開館前から行列で、やや出鼻を挫かれる。</p>

<p>年代順に作品が並ぶ。初期からかなり完成された画風ではあったようだ。話の筋を思い出しながらアーサー王の死やサロメを見ていくと、もはや挿絵ではなく、絵に話が付いているような気もしてくる。未刊行のポー作品集の挿絵は知らなかったが、「黒猫」といい「アッシャー家の崩壊」といい、雰囲気が抜群だ。死ぬ直前の作品では書き込みが尋常じゃなくなっていき、この辺りになると好みからは外れてくる。それでも白黒というだけでただただ魅惑されてしまう。いずれ現代の白黒イラスト代表としてエドワード・ケアリーとでも並べて鑑賞できる機会でもあったらうれしい。</p>

<p>活動期間が短いせいか、年代順にすると同じような作品を並べざるを得ず、見ていて飽きてくる。そして、飽きさせないよう、ギュスターヴ・モローやアルフォンス・ミュシャの作品が挟まるが、それらの持つ存在感が圧倒的すぎる。ピアズリーの作品が負けているように感じられてしまい、その魅力がくすんでしまう。本の状態での展示方法も含め、全体的に構成に問題があるように感じる。</p>

<p>各展示室の終わり辺りの壁には、作品の一部を大きく拡大した細長のパネルが床から天井まで貼られている。部屋を移動する時に作品の持つ雰囲気が鮮やかに蘇るような、後ろ髪を引かれるような、良い余韻を与えてくれるものだ。他、壁の色も含めて、展示室の意匠は良かったと思う。</p>

<hr>

<figure>
<picture>
<source srcset="/img/blog/beardsley-a-singular-prodigy-2025-02-28-room-of-bricks.avif" type="image/avif">
<img alt="レンガで作られた壁は左右にアーチ付きの出入り口がある。その間は少し手前にせり出しており、そこに寄せて木製のベンチが並べられている。ベンチには表紙が青い展覧会の図録が置かれている。" height="1440" src="https://hail2u.net/img/blog/beardsley-a-singular-prodigy-2025-02-28-room-of-bricks.jpg" width="2560">
</picture>
<figcaption>レンガの部屋</figcaption>
</figure>

<p>美術館自体は、リニューアルというほどではない。色々ときれいになっているようにも思えたが、久しぶりすぎて覚えていない(レオナルドとミケランジェロの展覧会以来だったように思う)。雰囲気が大きく変わるということもなく、壁龕や、扉、階段、照明を堪能できる。壁龕というか、アルコーブというか、部屋の凹んだ場所は大好きだ。</p>

<p>展示室は天井が黒くなったからか暗めになったような気もするが、雰囲気は良い。天井を走る黒い空調の配管もちょっと好きだ。ミュージアム・ショップも特に変わっていないので、相変わらず狭い。首が持ち上げられている方のサロメのポスト・カードが並んでいないものの、ちょうど再入荷したところらしく、奥から出してもらえた。ポスターが欲しかったが、この絵ははないらしい。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[面白いのかどうかよくわからないまま見続けている。今までの歴史ものと違って、まったく話の筋を知らないということもあり、新鮮に見ていられることは確かだ。ただ、主人公と相手役以外の全員がろくでなしで、まともな人が2人くらいしかおらず、うち1人は退場してしまい、登場人物の誰にも感情移入ができていない。主人公の相手役の声とオープニングの背景アニメーションがかっこいいということはわかった。]]></description>
        <guid>https://hail2u.net/blog/2025-02-28.html</guid>
        <link>https://hail2u.net/blog/2025-02-28.html</link>
        <pubDate>Fri, 28 Feb 2025 17:50:10 +0900</pubDate>
        <title><![CDATA[「べらぼう」視聴継続中]]></title>
        <content:encoded><![CDATA[<p>面白いのかどうかよくわからないまま見続けている。今までの歴史ものと違って、まったく話の筋を知らないということもあり、新鮮に見ていられることは確かだ。ただ、主人公と相手役以外の全員がろくでなしで、まともな人が2人くらいしかおらず、うち1人は退場してしまい、登場人物の誰にも感情移入ができていない。主人公の相手役の声とオープニングの背景アニメーションがかっこいいということはわかった。</p>

<p>「どうする家康」は半年くらいで挫折したが、オープニングの背景アニメーションは好きだった。「べらぼう」でもオープニングがお気に入りで、特に前振りの映像を止めてから浮世絵風・版画風の画像にすり替えオープニングへ切り替わる、という演出にまんまと乗せられている。線画大好きなので、こういうものに弱い。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[文字の大きさの決定方法にはいくつかあるが、ウェブページにおいては画面の横幅を基準に行うことが多い。紙媒体での伝統を踏まえたものだ。縦横比の種類が限られ、画面の横幅から画面の大きさが推測できた時代はそれで良いが、折りたたみスマートフォンやヘッドマウンテッド・ディスプレイなども含め、多様化どころではない時代にはそぐわないように思う。どうせ横幅には制限をかけるだろうから、縦幅にどれくらい流し込むか、つまり画面に何行入るかで文字の大きさを決めたらどうだろうか。]]></description>
        <guid>https://hail2u.net/blog/how-many-lines-on-a-display.html</guid>
        <link>https://hail2u.net/blog/how-many-lines-on-a-display.html</link>
        <pubDate>Thu, 27 Feb 2025 11:33:12 +0900</pubDate>
        <title><![CDATA[画面に何行入るか]]></title>
        <content:encoded><![CDATA[<p>文字の大きさの決定方法にはいくつかあるが、ウェブページにおいては画面の横幅を基準に行うことが多い。紙媒体での伝統を踏まえたものだ。縦横比の種類が限られ、画面の横幅から画面の大きさが推測できた時代はそれで良いが、折りたたみスマートフォンやヘッドマウンテッド・ディスプレイなども含め、多様化どころではない時代にはそぐわないように思う。どうせ横幅には制限をかけるだろうから、縦幅にどれくらい流し込むか、つまり画面に何行入るかで文字の大きさを決めたらどうだろうか。</p>

<p>例えば行送りが1.5の30行とすると、縦幅1080ピクセルの画面では以下のように計算できる。30という数字は手元にあった<em>判型が特殊な</em>横書きの本から借用する。また、1080ピクセルという数字はフルHDのディスプレイの解像度から借用する。</p>

<pre>1080px / (1.5 * 30) = 24px</pre>

<p>大きめの画面で大きめの文字サイズということになり、直観的には悪くなさそうな雰囲気がある。縦幅が100ピクセル増えると、文字サイズが<code>2.222px</code>大きくなる計算だ。4Kディスプレイなら縦1920ピクセルなので、<code>42.667px</code>になる。実際にはブラウザーのGUI領域などでもう少し小さいだろう。CSSでは描画領域の高さを<code>*vh</code>単位で参照できるので、以下のように書ける。最低でもこれくらい入るという観点で決めたいので、<code>svh</code>単位にしたい。</p>

<pre><code>:root {
  font-size: calc(<mark>100svh / (1.5 * 30)</mark>);
}</code></pre>

<p>このままではユーザー設定の文字サイズよりも小さくなる可能性がある。スマートフォンを横向きで使う時はそうなってしまうだろう。下限はユーザーの文字サイズ設定を尊重しなければならない。上限が難しいところだが、<code>48px</code>とし、4Kディスプレイでも到達しないくらいにしておく。<code>calc</code>関数を<code>clamp</code>関数に変え、最小値で<code>%</code>を、最大値で<code>px</code>単位を使う。</p>

<pre><code>:root {
  font-size: clamp(<mark>100%</mark>, 100svh / (1.5 * 30), <mark>48px</mark>);
}</code></pre>

<p>最近のスマートフォンなど、縦横比が2:1を超えるような縦長の機器では大きくなりすぎる懸念がある。縦長の機器では紙媒体と挙動が似ていると考えられるので、1行の文字数、つまり列数を固定してみたい。列数は、余白を考慮すると1行の文字数が35文字から38文字(<a href="https://en.wikipedia.org/wiki/Line_length">半角英数字で70文字から75文字</a>)くらいとなる40文字としてみる。これを<code>min</code>関数を使って、うまく切り替わるようにする。</p>

<pre><code>:root {
  font-size: clamp(
    100%,
    <mark>min(
      100svh / (1.5 * 30),
      100svw / 40
    )</mark>,
    48px
  );
}</code></pre>

<p>これで行数と列数の両方で収まりが良いと考えられる大きさになる。描画領域に対する文章の圧(表現が難しいが、埋まり具合とか密度とか、そのような感覚のこと)が一定になるだろう。行数と列数は厳密なものではないので、それらの平均を取って<code>svmin</code>単位を割ることで<code>min</code>関数の計算結果に近い値を出しても良いかもしれない。</p>

<pre><code>:root {
  font-size: clamp(
    100%,
    <mark>100svmin / ((1.5 * 30 + 40) / 2)</mark>,
    48px
  );
}</code></pre>

<p>テキトウに横幅に応じて大きくしていくよりは論理的だが、複雑性がかなり残る。ユーザーが設定した文字の大きさを優先しつつ、なるべく収まりの良い大きさを提供するという手法を具現化しただけなので、まだまだ手を入れるべきところはあるだろう。他の手法も考えつつ研ぎ澄ませたい。</p>

<hr>

<pre><code>:root {
  --ratio: calc(pow(3, 2) / pow(2, 3));
  --line-height-default: calc(pow(var(--ratio), 4));
  --ratio-column: calc(pow(var(--ratio), 32));

  font-size: max(
    100%,
    min(
      100svh / (var(--line-height-default) * 28),
      100svw / var(--ratio-column),
      24px
    )
  );
}</code></pre>

<p>手元ではこのような実装にしてみている。<code>max</code>関数で<code>100%</code>とその他に分けることで、ユーザー設定を優先することを明示的にする。実際の調整は<code>min</code>関数の方へ閉じ込め、マジック・ナンバーも極力使わないように気を付ける。<code>--line-height-default</code>という変数を28倍にして、高さを割るなら、画面に28行収まる文字の大きさになると推察できるはずだ。また、最大サイズも<code>24px</code>と控えめなものにした。タブレット端末のようなそこそこ大きい上に縦横比が正方形に近づく端末で、やや大きくなる傾向があるからだ。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[Late Night Talesシリーズを集め終わった。2022年に発掘して以来、数か月ごとに$8くらいのFLACを買っていた。2021年のJordan Rakeiで最後だったので助かった。全42枚あることだし、これらだけで生きていける気がしている。]]></description>
        <guid>https://hail2u.net/blog/2025-02-26.html</guid>
        <link>https://hail2u.net/blog/2025-02-26.html</link>
        <pubDate>Wed, 26 Feb 2025 11:57:28 +0900</pubDate>
        <title><![CDATA[Late Night Talesの収集完了]]></title>
        <content:encoded><![CDATA[<p><a href="https://latenighttales.co.uk/">Late Night Talesシリーズ</a>を集め終わった。<a href="https://hail2u.net/blog/2022-05-19.html">2022年に発掘</a>して以来、数か月ごとに$8くらいのFLACを買っていた。2021年のJordan Rakeiで最後だったので助かった。全42枚あることだし、これらだけで生きていける気がしている。</p>

<p>アルバムごとに1つのMP3ファイルにして変換している。Windowsのメディア・プレーヤー・アプリやiOSのミュージック・アプリがアルバム・シャッフルに対応しないのが悪い。寝る前の読書時間に、音量を絞って流していると、読書がはかどる上に寝入りも良い。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[部屋着をあまり着ないようにしていたが、去年くらいから真夏以外にも下だけ部屋着に着替えるようになった。一昨年に買った普段着のパンツが埃をクイックルするような素材で、それに毎回ブラシを書けることが面倒になったからだ。スウェットパンツというのも抵抗があったため、秋から春は柔らか目のチノパンを着ていた。楽すぎてゴロゴロしやすすぎるので封印する。]]></description>
        <guid>https://hail2u.net/blog/2025-02-25.html</guid>
        <link>https://hail2u.net/blog/2025-02-25.html</link>
        <pubDate>Tue, 25 Feb 2025 12:38:23 +0900</pubDate>
        <title><![CDATA[部屋着の封印]]></title>
        <content:encoded><![CDATA[<p>部屋着をあまり着ないようにしていたが、去年くらいから真夏以外にも下だけ部屋着に着替えるようになった。一昨年に買った普段着のパンツが埃をクイックルするような素材で、それに毎回ブラシを書けることが面倒になったからだ。スウェットパンツというのも抵抗があったため、秋から春は柔らか目のチノパンを着ていた。楽すぎてゴロゴロしやすすぎるので封印する。</p>

<p>部屋着を着ていると、筋トレがしやすいことに気付く。筋トレ観点で部屋着の誘惑に負けそうになっている。筋トレでパンツと靴下を脱いだついでに風呂を洗うという運用にし、この誘惑と戦っている。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[日本語などの約物に含まれる空白(例えば、開き鍵括弧の左にある空白)などを文脈に応じて詰めるtext-spacing-trimプロパティーがChrome 123やEdge 123で一部実装されている。特に指定せずにいたり、:root要素などでtrim-firstなどを指定すると、初期値の関係や継承によりpre要素でも詰められる。そうすると(対応するOpenType機能であるhaltを所持している)等幅フォント(例えばNoto Sans Mono CJK JP)で描画される場合に文字位置がずれてしまう。]]></description>
        <guid>https://hail2u.net/blog/text-spacing-trim-property-and-pre-element.html</guid>
        <link>https://hail2u.net/blog/text-spacing-trim-property-and-pre-element.html</link>
        <pubDate>Fri, 21 Feb 2025 12:14:55 +0900</pubDate>
        <title><![CDATA[text-spacing-trimプロパティーとpre要素]]></title>
        <content:encoded><![CDATA[<p>日本語などの約物に含まれる空白(例えば、開き鍵括弧の左にある空白)などを文脈に応じて詰める<a href="https://www.w3.org/TR/css-text-4/#propdef-text-spacing-trim"><code>text-spacing-trim</code>プロパティー</a>がChrome 123やEdge 123で<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-spacing-trim#browser_compatibility">一部実装</a>されている。特に指定せずにいたり、<code>:root</code>要素などで<code>trim-first</code>などを指定すると、初期値の関係や継承により<code>pre</code>要素でも詰められる。そうすると(対応するOpenType機能であるhaltを所持している)等幅フォント(例えばNoto Sans Mono CJK JP)で描画される場合に文字位置がずれてしまう。</p>

<p>仕様で初期値の<code>normal</code>はChrome 123やEdge 123の実装でも採用されている。この値では、日本語の約物が続く場合(例えば」「や。「など、<a href="https://www.w3.org/TR/css-text-4/#example-eec02af5">Text Module Level 4仕様のExample 41</a>を参照)にどちらかの約物の持つ空白を詰めるよう指示する。この値は継承されるため、<em>無指定でも<code>pre</code>要素で詰められる</em>ことから、文字が揃うかどうかは<em>ユーザーのフォント設定に依存する</em>可能性が高い。なぜならば制作者CSSにおいて<code>pre</code>要素のフォント指定で日本語の等幅フォントを指定することは少なく、この詰めが起こる日本語の約物はユーザーの設定したフォントやブラウザーの初期設定のフォントで描画されるからだ。</p>

<p>つまり<code>pre</code>要素では<code>text-spacing-trim: space-all</code>を必ず指定しておき、継承されないようにし、ずれないことを保証するべきではないかと考えられる。ルート要素などで<code>text-spacing-trim</code>プロパティーを使っていなくてもずれるかもしれないので、リセットやノーマライズの仕組みに組み込むのが妥当だと思う。副作用は無いと思われる。</p>

<p><code>pre</code>要素がこのプロパティーを継承してしまう仕様が悪いのか、等幅フォントなのに空白の詰めを司るOpenType機能を持っているフォントが悪いのか、微妙なところかもしれない。仕様側で要素によって既定値を変えて欲しいような気もするが、既に実装があるので面倒そうだ。制作者CSS側でほぼ確実に対処できるので、対処しておくに越したことはない。</p>]]></content:encoded>
      </item>
  </channel>
</rss>
