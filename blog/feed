<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
  xml:lang="ja"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:creativeCommons="http://backend.userland.com/creativeCommonsRssModule">
  <channel>
    <description>ウェブ開発に関する話題が中心でしたが、もはやそれに限らず備忘録に近いものです。</description>
    <link>https://hail2u.net/blog/</link>
    <managingEditor>hail2u@gmail.com (Kyo Nagashima)</managingEditor>
    <title>雑多な記録 - Hail2u</title>
    <atom:link href="https://hail2u.net/blog/feed" rel="self" type="application/rss+xml"/>
    <creativeCommons:license>https://creativecommons.org/licenses/by/4.0/</creativeCommons:license>

      <item>
        <description><![CDATA[ネットが緩んで外れかかっていた網戸を自分で張り替える。使っていない物置き部屋だったので、5年くらい見ないふりをしていた。色々物が片付いたら。気になるようになってしまい、張り替えることにする。初めて自分でやり、失敗ではない程度にはうまくいき、この湿気の多い季節でピンとしている。これなら一年中ピンとしたままだろう。]]></description>
        <guid>https://hail2u.net/blog/2025-07-18.html</guid>
        <link>https://hail2u.net/blog/2025-07-18.html</link>
        <pubDate>Fri, 18 Jul 2025 12:19:59 +0900</pubDate>
        <title><![CDATA[自分で網戸の張り替え]]></title>
        <content:encoded><![CDATA[<figure class="mat">
<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B00C5V8YQE/hail2unet-22"><img alt="ダイオ ミドリ アルミ網戸 張り替え用 ツインローラー NW 211819" height="500" src="https://m.media-amazon.com/images/P/B00C5V8YQE.jpg" width="500"></a>
</figure>


<p>ネットが緩んで外れかかっていた網戸を自分で張り替える。使っていない物置き部屋だったので、5年くらい見ないふりをしていた。色々物が片付いたら。気になるようになってしまい、張り替えることにする。初めて自分でやり、失敗ではない程度にはうまくいき、この湿気の多い季節でピンとしている。これなら一年中ピンとしたままだろう。</p>

<p>何も道具がないので、初心者セットにしようと思ったが、張り替える網戸が6.8mmの押さえゴムだったため対応していない。<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B00C5V8YQE/hail2unet-22">ローラー</a>と、<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B002DD854U/hail2unet-22">押さえゴム</a>、そして<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B002DD84YQ/hail2unet-22">ネット</a>をヨドバシで買う。腰高半間の2枚分が800円弱で揃うようだ。クリップやカッターは買わなかった。</p>

<p>あとは説明書き通りに、仮止めしてローラー、仮止めしてローラー、仮止めして引っ張りながらローラー、仮止めして引っ張りながらローラーと、張っていく。クリップはなくても大丈夫そうだ。張り替える網戸が1枚なので、失敗する余裕があり、気軽にできた。ゴムとネットの切断が難しい。専用カッターはあっても良かったかもしれないが、普通のカッターでもなんとかなる。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[あまり使っていない部屋のカーテン・レールが古く、中央のランナーにマグネットが付いていない。風が強い日に窓を開けていると、カーテンが吹っ飛んでしまう。見ないふりをしていたが、重い腰を上げて交換することにする。探してみたら、中央だけ交換できるものがすぐに見つかる。こんなことなら10年位前にどうにかすれば良かった。]]></description>
        <guid>https://hail2u.net/blog/2025-07-14.html</guid>
        <link>https://hail2u.net/blog/2025-07-14.html</link>
        <pubDate>Mon, 14 Jul 2025 07:15:28 +0900</pubDate>
        <title><![CDATA[カーテンのマグネット・ランナー]]></title>
        <content:encoded><![CDATA[<p>あまり使っていない部屋のカーテン・レールが古く、中央のランナーにマグネットが付いていない。風が強い日に窓を開けていると、カーテンが吹っ飛んでしまう。見ないふりをしていたが、重い腰を上げて交換することにする。探してみたら、中央だけ交換できるものがすぐに見つかる。こんなことなら10年位前にどうにかすれば良かった。</p>

<p>ニトリなどでも売っているが、イオンで買う。イオンのやつはカーテン・レールの真ん中から差し込んでひねるだけで追加できるからだ。1組で400円強と、カーテン・レールの値段を考えると、少し高く感じる。近所のイオン(やダイエー)は10時前に開いていて、市役所や図書館で早めに用を済ませた後、空いている時間に買い物ができて便利だ。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[Appleアカウントへのサインインくらいにしか使っていないiCloudメールへ迷惑メールが頻繁に来るようになった。送信元がメルカリや、ANAマイレージ、えきねっと、佐川急便、TEPCOカスタマーセンター、イオンカード、クロネコメンバーズ、アマゾン、楽天銀行などだ。すべて日本の会社を騙ったもので、日本人だとばれている。]]></description>
        <guid>https://hail2u.net/blog/2025-07-11.html</guid>
        <link>https://hail2u.net/blog/2025-07-11.html</link>
        <pubDate>Fri, 11 Jul 2025 08:09:37 +0900</pubDate>
        <title><![CDATA[iCloudメール宛て迷惑メール]]></title>
        <content:encoded><![CDATA[<p>Appleアカウントへのサインインくらいにしか使っていないiCloudメールへ迷惑メールが頻繁に来るようになった。送信元がメルカリや、ANAマイレージ、えきねっと、佐川急便、TEPCOカスタマーセンター、イオンカード、クロネコメンバーズ、アマゾン、楽天銀行などだ。すべて日本の会社を騙ったもので、日本人だとばれている。</p>

<p>当初はブラックキャット運送とかだったものが、ヤマト運送になり、ヤマト運輸、クロネコメンバーズ、と順調に学習している。迷惑メールへの自動振り分けはうまく機能しており、開くことはないのであまり問題はない。ただ、どういう経路で漏れたのかは気になる。5文字と短めなので、適当に探して見つかってしまっただけかもしれない。</p>

<p>一方でGmail宛ての迷惑メールはついに20通/月を切るくらいまで減った。最盛期は500通/月くらいだったが、インターネットでの活動の縮小と共に減っていき、ここまで減った。SMSや電話へも減りつつあるし、新たな牧草地を求めて色々探しているのだろうか。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[この定期リリースでは、グリッドやフレックスボックスなどのスキマに置く装飾を柔軟に定義するためのGap Decorations、カスタム関数を定義するためのFunctions and Mixins、これら2つが追加される。追加のためマイナー番号が上がり、v2.8.0だ。最近は追加が多い。いつの間にやら追加したCSS仕様も120を超えている。]]></description>
        <guid>https://hail2u.net/blog/vim-css3-syntax-v2.8.0.html</guid>
        <link>https://hail2u.net/blog/vim-css3-syntax-v2.8.0.html</link>
        <pubDate>Wed, 9 Jul 2025 07:01:57 +0900</pubDate>
        <title><![CDATA[vim-css3-syntax v2.8.0]]></title>
        <content:encoded><![CDATA[<p>この定期リリースでは、グリッドやフレックスボックスなどのスキマに置く装飾を柔軟に定義するための<a href="https://www.w3.org/TR/2025/WD-css-gaps-1-20250417/">Gap Decorations</a>、カスタム関数を定義するための<a href="https://www.w3.org/TR/2025/WD-css-mixins-1-20250515/">Functions and Mixins</a>、これら2つが追加される。追加のためマイナー番号が上がり、<a href="https://github.com/hail2u/vim-css3-syntax/releases/tag/v2.8.0">v2.8.0</a>だ。最近は追加が多い。いつの間にやら追加したCSS仕様も120を超えている。</p>

<p>Gapsはブラウザー・ベンダーからの提案が元になる。名前からも分かるようにスキマを装飾するものだ。つまり今まで項目への装飾に限られていたことに由来する、スタイル指定が冗長になりがちな問題(最後の項目だけスタイルを変える、または<code>:not()</code>セレクターで最後の項目だけ除外するなど)や、折り返しにうまく対応できない問題などが解決する。余白を装飾するという概念がとても西洋的だなと思うが、便利にはなりそうだ。</p>

<p>Mixinsは増え続けるCSS関数の決定版という格好だ。引数を使って、値を返す。ただしSassのミックスインのように複数のCSS定義(プロパティーと値の組)を返したりはできない。上流のカスタム・プロパティーが関数内で読めたりするので、JavaScriptなどプログラミング言語よりもあやふやで危険な点は気を付けたい。名前付け問題が発生しやすいとも言えるので、リンターが重要そうだ。似たようなCSS関数をDRYにしたり、複雑になりがちなCSS関数(グラデーションなど)を隠蔽するような、ショートカット的な利用が主になるだろう。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[川を渡り、坂を上り、店を見回り、電車に乗る。気温は高く、湿度も高い。ずっと曇りで、雨に怯えながらフラフラする。]]></description>
        <guid>https://hail2u.net/blog/nakameguro-daikanyama-yokohama-2025-07-02.html</guid>
        <link>https://hail2u.net/blog/nakameguro-daikanyama-yokohama-2025-07-02.html</link>
        <pubDate>Mon, 7 Jul 2025 13:11:49 +0900</pubDate>
        <title><![CDATA[中目黒～代官山～横浜]]></title>
        <content:encoded><![CDATA[<figure>
<img alt="完全にコンクリートで舗装された川はかなり水位が低いようだ。奥には赤い柵の歩行者用の橋がかかり、更にその上には駅のホームがあり、ちょうど電車が止まっている。川の左右のサクラはわさわさして夏らしい木陰を作っている。" height="1440" src="https://hail2u.net/img/blog/nakameguro-daikanyama-yokohama-2025-07-02.avif" width="2560">
</figure>

<p>川を渡り、坂を上り、店を見回り、電車に乗る。気温は高く、湿度も高い。ずっと曇りで、雨に怯えながらフラフラする。</p>

<p>相鉄線は東横線に乗り入れているが、最寄り駅からはその電車はあまりない。しょうがないので目黒線へ乗り入れる方に乗り、武蔵小杉駅で乗り換える。横浜周りの方が早い様な気もするが、乗り換えが大変そうだ。目黒線へ乗り入れる電車は8両編成ということを忘れ、止まらないところで待ってしまう。</p>

<p>日吉駅あたりから混み始める。日吉駅から田園調布駅までは色々な電車が同じホームで運用されていて、初見殺しのような気がしないでもない。行き先が遥か彼方なので、それからどこを通るのかを推測することは難しい。乗り入れからも時間が経って、さすがに慣れてきているので、間違えずに東横線に乗り換える。</p>

<p>目黒川を久々に見る。近くに行くことはよくあるが、目黒川の方、山手線の外に向かって行くことがあまりない。3年前に目黒天空庭園あたりのインテリア・ショップに行った時以来だろう。これぞ都会の川という趣で、見ると落ち着いてしまう。まだ早いが美術館へ向かう。</p>

<hr>

<figure>
<img alt="ややきつい傾斜の坂道は滑り止めの丸いくぼみが一面に施されている。登りきったところにある信号機は縦型で、なかなか珍しい。" height="1440" loading="lazy" src="https://hail2u.net/img/blog/nakameguro-daikanyama-yokohama-2025-07-02-vertical-traffic-light.avif" width="2560">
<figcaption>上村坂</figcaption>
</figure>

<p>美術館からは旧朝倉家住宅やエジプト大使館をぐるっと回りこむように歩く。この辺りを初めて上っていったが、想像以上に坂がきつい。もうちょっと緩やかに上っていくような印象だったが、麻布十番あたりと同じくらいの高低差だ。</p>

<p>代官山に着いたら、道路を渡り、蔦屋書店をだらだら眺める。雑誌のバックナンバーを読み耽っていたら、瞬く間に1時間くらい過ぎてしまう。特に買うものもないので、表の方から出る。</p>

<figure>
<img alt="やや濃いベージュ色の石畳で覆われた通路は、緑で覆われている。薄茶色の木材で覆われた建物と調和が取れている。" height="1440" loading="lazy" src="https://hail2u.net/img/blog/nakameguro-daikanyama-yokohama-2025-07-02-forestgate.avif" width="2560">
<figcaption>フォレストゲート・脇</figcaption>
</figure>

<p>ヒルサイドテラスのキッチン用品店や、洋服店をいくつか眺める。どうも水曜定休の店が多いようだ。ザ・コンラン・ショップも定休日だ。服を買わない年次だし、しょうがないので、駅直ぐにあるフォレストゲートに向かう。<a href="https://etnunc.jp/">パン屋</a>はいい香りで、当たりのようだ。やや高いものの、食事パンも多く、また来たい。購入したバゲットやゴマのカンパーニュは、やや好みの触感ではないもののなかなか美味しい。</p>

<hr>

<p>代官山駅から一気に横浜駅に出て、昼ごはんにする。地下街は混んでいたので、商業施設の上で唐揚げを食べる。家の唐揚げは手羽中ばかりなので、たまにモモ肉を食べると違和感がある。全体的に美味しいものの、ご飯があまり美味しくない。</p>

<p>セール前で商業施設は空いている。躊躇っているスニーカーの直営店が出来ていたので見に行く。セールで下がったら買おうかなどと、下がりそうもないのに考えている。無印良品の染め直し品で冬用の黒いセーターがあったら買おうかと思って見に行ったが、扱いがなくなったようで残念だ。</p>

<figure>
<img alt="灰色で三角形をした地味なつり革の中に、オレンジ色でネコ型の持ち手に、青いストラップのものが混ざっている。相鉄線のキャラクターであるそうにゃんを模したもののようだ。" height="1440" loading="lazy" src="https://hail2u.net/img/blog/nakameguro-daikanyama-yokohama-2025-07-02-sounyan-hanging-strap.avif" width="2560">
<figcaption>そうにゃんつり革</figcaption>
</figure>

<p>帰りの電車はガラガラで、余裕で座席に座れる。そうにゃんつり革の存在は知っていたが、じっくり眺めるのは初めてだ。1両に1つ必ずあるのだろうか。帰宅してからパン屋で買ったカルダモン・ロールを食べる。丸の内にあるパン屋のそれの方が美味しいかもしれない。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[中目黒駅近くにある郷さくら美術館へ、建物などを描いた日本画の展覧会を見に行く。現代日本画の作品を扱う美術館らしい。暑いので駅近の美術館にしたが、ふらふら歩いたので意味がない。]]></description>
        <guid>https://hail2u.net/blog/the-architecture-exhibition-2025-07-02.html</guid>
        <link>https://hail2u.net/blog/the-architecture-exhibition-2025-07-02.html</link>
        <pubDate>Fri, 4 Jul 2025 12:50:48 +0900</pubDate>
        <title><![CDATA[コンストラクション(郷さくら美術館)]]></title>
        <content:encoded><![CDATA[<figure>
<img alt="黒いタイルで覆われた建物と赤茶色のビルの間にブロック塀がある。そこに美術館の名称や展覧会名の掲示と共に、展覧会のポスターが並べられている。展示物をいくつか抜粋したポスターはかなり青い。" height="1440" src="https://hail2u.net/img/blog/the-architecture-exhibition-2025-07-02.avif" width="2560">
</figure>

<p>中目黒駅近くにある郷さくら美術館へ、<a href="https://www.satosakura.jp/?page_id=10211">建物などを描いた日本画の展覧会</a>を見に行く。現代日本画の作品を扱う美術館らしい。暑いので駅近の美術館にしたが、ふらふら歩いたので意味がない。</p>

<p>大体青いし、大体白い。サントリーニ島の教会やタージ・マハルはまさにそうだ。油やアクリルとは色の印象がずいぶん違うように感じる。パリ・リヨン駅やニューヨークのビルなどの青くない作品になると顕著になる気がする。単にガラス・ケースに入っていないからかもしれない。</p>

<p>現代日本画もあまり見てきていないこともあって、そこそこ新鮮に見られ、思ったよりも面白かった。屏風を見ているとパーティションが欲しくなる。来年くらいにもう一度行って、現代日本画への先入観を融解させたい。</p>

<hr>

<figure>
<img alt="20センチメートル四方くらいのタイルが並んでいる。タイルにはサクラを象った美術館のロゴに沿った切れ目があり、その隙間から向こう側が少し見えている。" height="1440" loading="lazy" src="https://hail2u.net/img/blog/the-architecture-exhibition-2025-07-02-tiles.avif" width="2560">
<figcaption>美術館・外壁囲い</figcaption>
</figure>

<p>建物は外壁の外に黒いタイルの壁で囲われており、ちょっと異形なビルだ。このタイルは美濃焼らしい。少し奥まっていることと、周囲に空間がないことで悪目立ちはしていない。それ以外は、内装も凝っておらず、ただのビルだ。展示室も横には広いが、縦には狭く、屏風絵などにはやや小さい。タイル以外には見るべきところはないだろう。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[2025年に至って、レスポンシブ・フォント・サイズの前提であった状況が変わりつつあるように思う。その状況とは、ブラウザーの閲覧領域(ビューポート)、特にその幅が閲覧中に変わらないということだ。幅がちょくちょく変化する状況では、レスポンシブ・フォント・サイズによって文字サイズが変化することは、レイアウトやフローがちょいちょい変化することに直結する。それがユーザー体験に与える影響は少なくないはずだ。]]></description>
        <guid>https://hail2u.net/blog/responsive-font-size-2025.html</guid>
        <link>https://hail2u.net/blog/responsive-font-size-2025.html</link>
        <pubDate>Wed, 2 Jul 2025 18:35:24 +0900</pubDate>
        <title><![CDATA[レスポンシブ・フォント・サイズが前提としている状況の変化]]></title>
        <content:encoded><![CDATA[<p>2025年に至って、レスポンシブ・フォント・サイズの前提であった状況が変わりつつあるように思う。その状況とは、<em>ブラウザーの閲覧領域(ビューポート)、特にその幅が閲覧中に変わらない</em>ということだ。幅がちょくちょく変化する状況では、レスポンシブ・フォント・サイズによって文字サイズが変化することは、レイアウトやフローがちょいちょい変化することに直結する。それがユーザー体験に与える影響は少なくないはずだ。</p>

<p>少し前まではデバイスの回転やフルスクリーンの切り替えなどでしか閲覧領域の幅は変わらなかった。しかし、昨年くらいからブラウザーの左右に様々なものが置かれるようになっている。具体的にはサイドバーとかサイドパネルとか呼ばれるものだ。それらがユーザーの行動によって切り替えられ、それに押されてちょくちょく幅が変わるようになった。対話型AIのブラウザーへの搭載が一番大きいが、それ以外にも色々ある。</p>

<p>これらサイドなんとかは、一時的と言うには少し長い時間、補助的と言うには少し広い大きさで使われる。開いたらそこでちょっとした作業を行い、しばらくしてからそれを閉じて戻ってくるというわけだ。作業途中でうっかり閉じたりされないよう、閲覧領域を狭めて開かれる。</p>

<p>ちょっと前までは瞬間的な利用で終わること(単語の翻訳とか)を想定して、オーバーレイのメニューやツールチップであることが多かった。そうでないやや複雑な作業なら、現在のページを丸ごと置き換えるか、新しいタブで開かれただろう。そのため閲覧領域の幅が変わることはなかった。</p>

<p>今の一般的なCSSの書き方だと、幅が変わると文字サイズが変わり、文字サイズが変わるとほぼ全てが変わる。リフローどころではない、文字数や行数の調節、折り返し位置の大幅な変更(<code>text-wrap: balance;</code>で顕著だ)、画像の大きさの調節と、レイアウトの切り替わり、などといった劇的な変化が起こる。そしてサイドなんとかは広くとられる傾向にある(私はブラウザーの半分くらいの幅で開いており、閲覧領域の幅は600px前後にまで減る)ので、より破壊的になるだろう。</p>

<p>もちろんそれで崩れてしまうようなウェブページは論外だが、きちんと「レスポンシブ」であっても、いや「レスポンシブ」だからこそ問題は起きる。これらを開く時は何か作業をする時で、その時に右や左でがちゃがちゃと色々切り替わってしまうと、作業への集中力が削がれてしまうという問題だ。長くて1秒もないくらいだろうが、いざ集中先を切り替えようという時に、元の場所で何か動きがあった場合、それを無視することは難しい。</p>

<p>もはや閲覧領域の幅に依存して文字サイズを変えてしまうと、つまりレスポンシブ・フォント・サイズを採用してしまうと、ユーザー体験が悪化するのではないか、と考えている。もしかすると以前のように初期の横幅に応じて動的にCSSを配布すると、文字サイズを柔軟にしつつ安定するので、使いやすい可能性すらある。どうせ見ないし操作しないので、横スクロールバーが出ても問題ない。ともあれ少なくともサイドなんとかが頻繁に切り替えられるということを想定したウェブデザインが求められ始めているとは感じる。</p>

<hr>

<p>そんなこんなで<code>max(100%, 20px)</code>というような閲覧領域に依存しない文字サイズ指定に回帰している。最低でも閲覧者が指定している文字サイズか20pxのどちらかになる。狭いスマフォ(幅400ピクセル以下)でやや大きいような気がするし、そのあたりを何とかしたいが、うまい方法を思いついていない。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[2年くらい行われている、法面とその上にある林の整備が終わりに近づいている。今は謎の物体が法面に取り付けられている。どういう効果があるものなのだろうか。水抜きの穴を開け直す固定器具なようなもので、最終的には外されるんではないかと想像している。このままだと、酔っぱらって歩いている人が、飛び出ている硬い円柱に頭をぶつけてひどい目に遭いそうだ。]]></description>
        <guid>https://hail2u.net/blog/2025-06-30.html</guid>
        <link>https://hail2u.net/blog/2025-06-30.html</link>
        <pubDate>Mon, 30 Jun 2025 17:54:46 +0900</pubDate>
        <title><![CDATA[謎の物体と法面]]></title>
        <content:encoded><![CDATA[<figure>
<img alt="コンクリートで覆われた古い法面にひし形に近い八角形で巨大な金属製で出来た板状で灰色の物体が張り付けられている。この物体の中央には円柱形の突起があり、機械的な印象を受ける。" height="1440" src="https://hail2u.net/img/blog/weird-object-on-norimen.avif" width="2560">
</figure>

<p>2年くらい行われている、法面とその上にある林の整備が終わりに近づいている。今は謎の物体が法面に取り付けられている。どういう効果があるものなのだろうか。水抜きの穴を開け直す固定器具なようなもので、最終的には外されるんではないかと想像している。このままだと、酔っぱらって歩いている人が、飛び出ている硬い円柱に頭をぶつけてひどい目に遭いそうだ。</p>

<p>元々林が上にあり、少し雨風が強いと大きな枝が固まって落ちてきた。ナラ枯れ被害もあったようで、全体的に手を入れる……というか全伐採することになったらしい。夏はかなりの日陰を作ってくれていた林なので残念と思う一方、落ちてきた枝を避けたことも何回かあるため安全になったとも思っており、二律背反な感情を持っている。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[地元のジーンズ屋で4割引くらいの1490円でヘインズのビーフィーが売っている。Amazonより安いと思った瞬間にレジに持って行く。よそ行きに着ていた紺のTシャツを普段着にしたり、今年は2枚入れ替わる。色が褪せ切ったポロシャツと、襟がヨレヨレになった灰色のTシャツとさよならだ。黒のTシャツは久しぶりの気がする。]]></description>
        <guid>https://hail2u.net/blog/2025-06-27.html</guid>
        <link>https://hail2u.net/blog/2025-06-27.html</link>
        <pubDate>Fri, 27 Jun 2025 19:48:15 +0900</pubDate>
        <title><![CDATA[紺黒白紺白]]></title>
        <content:encoded><![CDATA[<p>地元のジーンズ屋で4割引くらいの1490円で<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B0DBPV1PP4/hail2unet-22">ヘインズのビーフィー</a>が売っている。Amazonより安いと思った瞬間にレジに持って行く。よそ行きに着ていた紺のTシャツを普段着にしたり、今年は2枚入れ替わる。色が褪せ切ったポロシャツと、襟がヨレヨレになった灰色のTシャツとさよならだ。黒のTシャツは久しぶりの気がする。</p>

<p>2年前くらいから5枚ローテーションに減らしている。Tシャツがめっきり高くなったので、普段着Tシャツを探すのも大変だ。1000円台のものは変化がないが、定番として4000円前後で売られていたものが大体7000円くらいまで上がっている印象だ。</p>]]></content:encoded>
      </item>
      <item>
        <description><![CDATA[JSONファイルを読み込むのにfsモジュールを使っているが、Dynamic Importでも書けるようなので置き換えてみている、いや、いた。実装が遅れていたFirefoxも、2025年4月末にリリースされた138でサポートしたので、試してみる気になった。短くならない上に、可読性も良くないことがわかる。import宣言ならJSONファイルを読み込む価値はあるが、かなり特別な理由がない限りDynamic ImportをJSONファイルの読み込みに使うことはやめた方が良さそうだ。]]></description>
        <guid>https://hail2u.net/blog/using-dynamic-import-for-a-json-file.html</guid>
        <link>https://hail2u.net/blog/using-dynamic-import-for-a-json-file.html</link>
        <pubDate>Wed, 25 Jun 2025 10:58:33 +0900</pubDate>
        <title><![CDATA[JSONファイルをDynamic Import]]></title>
        <content:encoded><![CDATA[<p>JSONファイルを読み込むのにfsモジュールを使っているが、Dynamic Importでも書けるようなので置き換えてみている、いや、いた。実装が遅れていたFirefoxも、2025年4月末にリリースされた138でサポートしたので、試してみる気になった。短くならない上に、可読性も良くないことがわかる。<code>import</code>宣言ならJSONファイルを読み込む価値はあるが、かなり特別な理由がない限りDynamic ImportをJSONファイルの読み込みに使うことはやめた方が良さそうだ。</p>

<pre><code class="language-javascript">import assert from &quot;node:assert&quot;;
import fs from &quot;node:fs/promises&quot;;

const obj1 = await fs.readFile(&quot;./test.json&quot;).then(JSON.parse);
const <mark>{ default: obj2 }</mark> = await import(&quot;./test.json&quot;, <mark>{
  with: { type: &quot;json&quot; }
}</mark>);
assert.deepStrictEqual(obj1, obj2);</code></pre>

<p>fsモジュールではBufferとして読んで、<code>JSON.parse()</code>に流す。1行で無理やり書いた感がすごい。これを書き換えたい動機としては、<code>utf8</code>と書かずに済むくらいの感覚で、<code>then</code>と<code>JSON.parse()</code>を書きたくないということに尽きる。fs-extraパッケージを使う気はないが、あれくらい短くスパッと書きたい。</p>

<p>Dynamic Importだと、<code>import()</code>の第二引数で<code>import</code>宣言と同じ<code>with</code>キーを使ってJSONファイルを読み込むことを教えれば良い。これだけだったら使いやすそうに思えるが、既定で<code>default</code>キーへJSONファイルの内容が展開されるので、分解文法を使って代入しないと使いづらい。そして<code>default</code>は予約語のため名前も変える必要がある。そんなこんなでなかなか長い。</p>

<p>長いだけならまだしも、{}が3組もあってかなり読みづらい。Dynamic Importの方が速そうな気はするが、それでも使う気は起きない。またうっかり<em>ドットで始まらない相対パス</em>を投げてしまうと、<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#module_specifier_resolution">Bare Specifier</a>とみなされて死ぬことも致命的な気配がある。上記例だと<code>test.json</code>と書いてしまうと、 Node.jsでは<code>test.json</code>という名前のパッケージを探しに行き、ERR_MODULE_NOT_FOUNDになるだろう。</p>]]></content:encoded>
      </item>
  </channel>
</rss>
