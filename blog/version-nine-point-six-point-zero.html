<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="light dark" name="color-scheme">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>変わっていないけど、変わっている</title>

    <style>
      body {
        font-family: sans-serif;
        font-size: 112.5%;
        margin-block-end: 25svh;
      }

      pre {
        white-space: pre-wrap;
      }

      figure {
        margin-inline: 0;
      }

      img,
      svg {
        block-size: auto;
        max-inline-size: 100%;
      }
    </style>
  </head>

  <body>
    <p><time>2020-03-13</time></p>

    <h1>変わっていないけど、変わっている</h1>

    <p>v9.5.0で右寄りレイアウトに戻した後、CSSを整理し、v9.6.0でヘッダーとフッターだけ幅いっぱい使うように戻した。結果があまり変わっていないのに、CSSだけ変わっている。いろいろな書き方ができるようになった上、新旧の知識が混ざるので、書き方が安定しない。他には、タグラインが最重要な見出しだと問題がありそうなので、最重要な見出しはページ名(雑記とか近況とか)にするようにした。CSSでそれにタグラインが追加される。</p>

<p>サムネイルの列数の調整は、<code>minmax()</code>を使うものに書き換えた。サムネイルの数が12の倍数なら余りが出ないとしたかったので、最大で4列に制限するようにする。これなら1列から4列で可変なので、必ず割り切れる。</p>

<pre><code class="language-css">.thumbs {
  display: grid;
  grid-gap: var(--space-small);
  grid-template-columns: repeat(
    autofill,
    minmax(
      calc(var(--width-main) / 5),
      1fr
    )
  );</code></pre>

<p>スペースを余らせずに(<code>autofill</code>)、均等に割り振りつつ(<code>1fr</code>)、最低でもコンテンツ幅(<code>--width-main</code>)の1/5は確保する、という<code>repeat()</code>関数はこうなる。最大で4列にしたいなら5で割ると簡単だ。<code>grid-gap</code>プロパティーがないなら4で良い。</p>

<p>メディア・クエリーを減らすために、以前からこうしようとは思っていた。しかし、昔は最大6列だったので、5列の時に割り切れないのが気に食わず、先送りしていた。しばらく前に最大4列に変えた時はすっかり忘れていた。12の力はすごい。</p>

<hr>

<p>基本フォント・サイズの調節を<code>calc()</code>を使って行うようにできれば、完全にメディア・クエリーを追放できそうだ。ユーザー設定のフォント・サイズを尊重しつつ、ビューポート幅に応じて基本フォント・サイズを調整し、<code>rem</code>単位で統一できるようにする方法が思いつかない。<a href="https://utopia.fyi/">Utopia</a>は興味深いけど、<code>body</code>要素でフォント・サイズを調節する前提なので、<code>rem</code>単位での統一は難しそうだった。これについては別にちょっと書く。</p>
  </body>
</html>
