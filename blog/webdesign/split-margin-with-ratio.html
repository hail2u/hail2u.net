<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">

    <title>余白を割合で分割</title>

    <link title="ウェブサイト全体のRSS" href="/feed" rel="alternate" type="application/rss+xml">
    
    <link title="雑多な記録だけのRSS" href="/blog/feed" rel="alternate" type="application/rss+xml">
    
    
    <link href="/apple-touch-icon.png" rel="apple-touch-icon">
    <link href="mailto:hail2u@gmail.com" rel="author me">
    <link href="https://hail2u.net/blog/webdesign/split-margin-with-ratio.html" rel="canonical">
    <meta content="light dark" name="color-scheme">
    <meta content="余白を特定の比率で分割したいなとちょっと考えていた。つまりmargin-leftとmargin-rightプロパティーの計算済みの値が3:2とかの比率で自動調節されるように、ということ。そのようなことをTwitterでちょっと書いたら、@o_tiがcalc()を使う方法を考えてくれた。" name="description">
    <link href="/" rel="home">
    <link href="/favicon.svg" rel="icon" type="image/svg+xml">
    <link href="/blog/" rel="index">
    <link href="https://creativecommons.org/licenses/by/4.0/" rel="license">
    <link href="https://github.com/hail2u" rel="me">
    <link href="https://x.com/hail2u_" rel="me">
    <link href="https://duckduckgo.com/?q=site%3Ahail2u.net" rel="search">
    <meta content="width=device-width" name="viewport">

    <link href="/css/print.css?v=9.32.0" media="only print" rel="stylesheet">
    <link href="/css/index.css?v=9.32.0" media="only screen" rel="stylesheet">

    <meta content="summary_large_image" name="twitter:card">
    <meta content="余白を特定の比率で分割したいなとちょっと考えていた。つまりmargin-leftとmargin-rightプロパティーの計算済みの値が3:2とかの比率で自動調節されるように、ということ。そのようなことをTwitterでちょっと書いたら、@o_tiがcalc()を使う方法を考えてくれた。" property="twitter:description">
    <meta content="https://hail2u.net/img/blog/split-margin-with-ratio.png" property="twitter:image">
    <meta content="@hail2u_" name="twitter:site">
    <meta content="余白を割合で分割" property="twitter:title">
  </head>

  <body>

      <nav id="top">
        <p class="logo"><a href="/"><svg viewBox="0 0 16 16" role="img" aria-labelledby="logo-title"><title id="logo-title">ホームへ戻る</title><path d="m 2,7 3,7 h 7 L 14,9 13,4 9,2 Z"/></svg></a></p>
      </nav>

      <header class="page-header">
          <p class="date"><time datetime="2014-07-13T09:07:10+09:00">2014年7月13日</time></p>

        <h1><em>余白を割合で分割</em></h1>
      </header>

    <main>

    <p>余白を特定の比率で分割したいなとちょっと考えていた。つまり<code>margin-left</code>と<code>margin-right</code>プロパティーの計算済みの値が3:2とかの比率で自動調節されるように、ということ。そのようなことをTwitterでちょっと書いたら、<a href="https://twitter.com/o_ti/status/487922228835516416">@o_tiが<code>calc()</code>を使う方法</a>を考えてくれた。</p>

<p>Demo: <a href="/pub/test/580.html">Split margins 1 to 3</a></p>

<p>最初のデモの幅は<code>320px</code>、二つ目のデモの幅は<code>480px</code>になっている。<code>margin-left</code>プロパティーで<code>calc()</code>を使い、<code>100%</code>から要素の幅を引いた残りを4で割っている。<code>margin-right</code>プロパティーは<code>auto</code>で自動調節すれば良い。</p>

<pre><code class="language-css">.test {
  margin-right: auto;
  margin-left: calc((100% -320px) / 4);
  width: 320px;
}</code></pre>

<figure>
<img alt="320pxの要素では260pxと780px、480pxの要素では220pxと660px、と1:3で余白が分割されている。" height="240" src="/img/blog/split-margin-with-ratio.png" width="640">
<figcaption>Inspect <code>margin-left: calc((100% - width) / 3)</code></figcaption>
</figure>

<p>開発者ツールを使って検証すると、それぞれの要素でちゃんと1:3になっていることが確認できる。残念ながら<code>calc()</code>でその要素の幅を参照するような仕組みはない(CSS Variables待ちだろうか)ので、それぞれで<code>calc()</code>を書かないとならないけど、やりたいことはこれで出来た。</p>

<hr>

<p>どうも僕は<code>calc()</code>を使うという発想に欠けている気がする。欲しがっていた割になかなか安心して使えるようにならなかったため、使わないで済むようにCSSを書くという教育されてきたからなのかも。現在<code>calc()</code>はデスクトップのブラウザーならほぼ自由に使えると言っていい状況。主に複雑なレイアウトの時に使うため、モバイル・ブラウザーでは必要性が少ないであろうと考えられるので、積極的に使うように意識改革してももう大丈夫なんじゃないかと思う。</p>

<hr>

<p><code>calc()</code>の中で<code>calc()</code>みたいなことしたいとかできなかったっけとかできないな……とか混乱した。落ち着いて考えた感じ、<code>calc()</code>内に<code>calc()</code>は書けないけど、<code>calc()</code>内の<code>(...)</code>は事実上<code>calc()</code>と同等なので、<code>calc()</code>内で<code>calc()</code>出来ると言って良さそう。</p>

<pre>&lt;calc()&gt; = calc( &lt;calc-sum&gt; )
&lt;calc-sum&gt; = &lt;calc-product&gt; [ [ &apos;+&apos; | &apos;-&apos; ] &lt;calc-product&gt; ]*
&lt;calc-product&gt; = &lt;calc-value&gt; [ &apos;*&apos; &lt;calc-value&gt; | &apos;/&apos; &lt;number&gt; ]*
&lt;calc-value&gt; = &lt;number&gt; | &lt;dimension&gt; | &lt;percentage&gt; | ( &lt;calc-sum&gt; )</pre>

<p><a href="http://dev.w3.org/csswg/css-values/">2014/06/22付けの開発版のCSS Values and Units Modules Level 3仕様</a>ではこのように<code>calc()</code>の計算が<code>()</code>でネストできることが、その文法の解説で明示されている。</p>

    </main>

    <footer class="page-footer">
        <nav>
          <p><a href="/blog/"><span aria-hidden="true">⬑ </span>雑多な記録の一覧</a></p>
        </nav>

      <p><a title="Creative Commons (表示)" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a> · <a href="mailto:hail2u@gmail.com">ながしまきょう / hail2u</a> (<a href="https://x.com/hail2u_">X</a> · <a href="https://github.com/hail2u">GitHub</a>)</p>

      <p><a href="/feed" type="application/rss+xml">RSS</a> (<a href="/blog/feed" type="application/rss+xml">雑多な記録だけのRSS</a>)</p>

      <p><a href="#top"><span aria-hidden="true">↑ </span>一番上</a></p>
    </footer>
  </body>
</html>
