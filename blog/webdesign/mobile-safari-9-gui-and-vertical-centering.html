<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="light dark" name="color-scheme">
    <meta content="same-origin" name="view-transition">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>Mobile SafariのGUIと天地センタリング</title>

    <style>
      body {
        font-family: sans-serif;
        font-size: 112.5%;
        margin-block-end: 25svh;
      }

      pre {
        white-space: pre-wrap;
      }

      figure {
        margin-inline: 0;
      }

      img,
      svg {
        block-size: auto;
        max-inline-size: 100%;
      }
    </style>
  </head>

  <body>
    <p><time>2016-05-08</time></p>

    <h1>Mobile SafariのGUIと天地センタリング</h1>

    <p><a href="/">このウェブサイトのホーム</a>を少しいじって初期描画エリアにロゴとグローバル・ナビゲーションだけにした。両者は<code>calc()</code>関数内で<code>vh</code>単位を使うことで天地センタリングを行ったが、どうもMobile Safari 9で表示がずれる。しかし実際にはずれておらず、単にコンテンツにかぶさってツールバーが表示されているため、下部の余白が足りないように見え、結果ずれているように見えてしまうということのようだ。</p>

<figure>
<img alt="Mobile Safari 9では下部UIが描画領域にかぶさり、コンテンツが一部カットされている。" height="1136" src="/img/blog/centering-vertically-with-calc-on-mobile-safari-9.png" width="640">
</figure>

<p>Demo: <a href="/test/649.html">Centering Vertically with Calc</a></p>

<p>テスト・ページでは<code>body</code>要素の背景へバツ印のSVG画像を仕込むことで描画領域の中心をマークしてある。<code>calc()</code>関数と<code>vh</code>単位をサポートしているデスクトップ・ブラウザーでは、見出しが問題なく中心に表示されているはずだ。対してMobile Safari 9では全体的に下に寄っているように見える。</p>

<p>これはMobile Safari 9のGUIに依存した問題だ。上部にあるアドレス・バーは描画領域にかぶさっていないのに対し、下部にあるツールバーは描画領域にかぶさっているため、その分確保したはずの余白が減ってしまうというわけだ。実際、少し下にスクロールさせてGUIを消し、GUIが再び現れない程度に上にスクロールさせて戻ると、きちんと中心に配置されていることが確認できる。</p>

<p>こういったことも考慮して天地センタリングは行うべきかもしれないが、かなり面倒なことになるだろう。それほど完全な中央という位置にこだわらないようなゆるいレイアウトを考えるという方が健全だ。このウェブサイトでは特に中央にはこだわってはおらず、ロゴとグローバル・ナビゲーション以外を表示しないという目的は達成できているので良しとしておいた。</p>

<hr>

<p><code>calc()</code>関数を解禁したので、無駄に色々なところでFlexible Boxも使うようにした。それほど楽になったわけでもない。特にマージンの相殺あたりで目算が狂うことが多々ある。<code>overflow: auto</code>などではないマージンの相殺を制御するためだけのCSSプロパティーがたまに欲しくなる。</p>
  </body>
</html>
