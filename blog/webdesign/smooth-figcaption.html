<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">

    <title>快い図のキャプション</title>

    <link title="ウェブサイト全体のRSS" href="/feed" rel="alternate" type="application/rss+xml">
    
    <link title="雑多な記録だけのRSS" href="/blog/feed" rel="alternate" type="application/rss+xml">
    
    
    <link href="/apple-touch-icon.png" rel="apple-touch-icon">
    <link href="mailto:hail2u@gmail.com" rel="author me">
    <link href="https://hail2u.net/blog/webdesign/smooth-figcaption.html" rel="canonical">
    <meta content="light dark" name="color-scheme">
    <meta content="画像に続けてfigcaptionをそのまま普通に表示するといまいちなことが多いです。それでも英語ならイタリック体にするとかでなんとなくその文字列がfigure要素に係っているものだということが表現できるような気がしますが、日本語の斜体はいろいろアレなので使いたくないです(よね！)。そこで画像にキャプションを綺麗に重ねる方法を模索してみました。" name="description">
    <link href="/" rel="home">
    <link href="/favicon.svg" rel="icon" type="image/svg+xml">
    <link href="/blog/" rel="index">
    <link href="https://creativecommons.org/licenses/by/4.0/" rel="license">
    <link href="https://github.com/hail2u" rel="me">
    <link href="https://x.com/hail2u_" rel="me">
    <link href="https://duckduckgo.com/?q=site%3Ahail2u.net" rel="search">
    <meta content="width=device-width" name="viewport">

    <link href="/css/print.css?v=9.32.2" media="only print" rel="stylesheet">
    <link href="/css/index.css?v=9.32.2" media="only screen" rel="stylesheet">
  </head>

  <body>

      <nav id="top">
        <p class="logo"><a href="/"><svg viewBox="0 0 16 16" role="img" aria-labelledby="logo-title"><title id="logo-title">ホームへ戻る</title><path d="m 2,7 3,7 h 7 L 14,9 13,4 9,2 Z"/></svg></a></p>
      </nav>

      <header class="page-header">
          <p class="date"><time datetime="2011-12-19T19:48:38+09:00">2011年12月19日</time></p>

        <h1><em>快い図のキャプション</em></h1>
      </header>

    <main>

    <figure>
<img alt="キャプション付きの犬の画像。" height="270" src="/img/blog/smooth-figcaption.png" width="480">
</figure>

<p>画像に続けて<code>figcaption</code>をそのまま普通に表示するといまいちなことが多いです。それでも英語ならイタリック体にするとかでなんとなくその文字列が<code>figure</code>要素に係っているものだということが表現できるような気がしますが、日本語の斜体はいろいろアレなので使いたくないです(よね！)。そこで画像にキャプションを綺麗に重ねる方法を模索してみました。</p>

<p>Demo: <a href="/test/330.html">Smooth Caption</a></p>

<p>まずは画像のHTMLです。</p>

<pre><code class="language-html">&lt;figure&gt;
  &lt;a href="http://example.com/"&gt;
    &lt;img src="http://example.com/images/logo.png"&gt;
  &lt;/a&gt;
  &lt;figcaption&gt;Example.com's Logo&lt;/figcaption&gt;
&lt;/figure&gt;</code></pre>

<p>このHTMLに対してどんなサイズの画像にも対応できるようにCSSを書いていきます。<code>a</code>要素には依存しませんが、入っていてもいなくても大丈夫なようにもします。</p>

<pre><code class="language-css">figure {
  display: inline-block;
  position: relative;
  line-height: 1;
  overflow: hidden;
}</code></pre>

<p>まずは<code>figure</code>要素を<code>inline-block</code>にします。こうすることによって内包される画像に合わせて<code>figure</code>要素のサイズが変化します。そして<code>position</code>や<code>overflow</code>プロパティーで効率的に<code>figcaption</code>をレイアウトできるようにしておきます。<code>line-height</code>プロパティーはなくてもうまくいくことがありますが、なるべく<code>1</code>にしておいたほうが良いでしょう。</p>

<pre><code class="language-css">figure img {
  vertical-align: text-bottom;
}</code></pre>

<p>次に画像の行ボックスに対する位置決めを行います。デフォルト値である<code>baseline</code>だと<code>figure</code>要素の下端に数ピクセルの隙間ができてしまいますが、<code>text-bottom</code>にすることによってその隙間を消すことができます。</p>

<p>最後に<code>figcaption</code>のデザインです。</p>

<pre><code class="language-css">figure figcaption {
  padding: 0 1em;
  position: absolute;
  right: 0;
  bottom: 0;
  width: 100%;
  line-height: 3;
  color: white;
  background-color: black;
  text-align: right;
  opacity: 0.75;
}</code></pre>

<p>幅は<code>width</code>プロパティーで<code>100%</code>を指定すると<code>figure</code>要素の幅一杯になります。つまり画像の幅と揃うことになりますね。<code>padding</code>プロパティーで左右に余白を確保しているので、実際には飛び出してしまいますが、<code>figure</code>要素で<code>overflow: hidden</code>となっているので問題ありません。高さは<code>line-height</code>プロパティーでやると、高さと同時に縦方向のセンタリングも行えるのでお手軽でしょう。</p>

<p>テキストを右寄せにしているので、全体の位置は<code>right</code>と<code>bottom</code>プロパティーで右下に合わせます。<code>overflow</code>で隠しているのでわかりませんが、実際には左に少し飛び出しています。左寄せにする場合は<code>left</code>を代わりに使いましょう。</p>

<p>色は普通に指定して<code>opacity</code>プロパティーで半透明にしていますが、このあたりは好みで良いでしょう。勿論背景画像を使っても大丈夫です。</p>

<p>これで最初にあげたスクリーンショットのような派手すぎないけど少しだけ凝ったキャプションになります。周囲のコンテンツとのマージンを工夫したりフォントや前景色を変更したりして、図のキャプションかそうでないかを判断できるようにするのが王道だと思いますが、フォントの自由さが足りない日本語のページではこういう方法もまぁ悪くないんじゃないかと思います。</p>

<p>やり過ぎると図が読み手に与えるイメージが揺らいでしまうので、キャプションが図よりも目立つような形にはするべきではないでしょう。図が主でキャプションが従になるように気をつけてデザインすると良いと思います。</p>

<section>
<h2>おまけ</h2>

<p>オンマウスでスルッとキャプションを隠す場合は位置をいじるよりも<code>line-height</code>プロパティーをいじった方がアニメーションさせやすいと思います。</p>

<pre><code class="language-css">.test figcaption {
  overflow: hidden;
  transition-duration: 0.5s;
}

.test:hover figcaption {
  line-height: 0;
  transition-duration: 0.5s;
}</code></pre>

<p><code>bottom</code>いじる場合はキャプションの高さを知らなくちゃいけないのでちょっと面倒なので。まぁ吹っ飛ぶくらいの量を適当に指定するとかで逃げるという手もありますけどね。</p>
</section>

    </main>

    <footer class="page-footer">
        <nav>
          <p><a href="/blog/"><span aria-hidden="true">⬑ </span>雑多な記録の一覧</a></p>
        </nav>

      <p><a href="mailto:hail2u@gmail.com">ながしまきょう / hail2u</a> (<a href="https://x.com/hail2u_">X</a> · <a href="https://github.com/hail2u">GitHub</a>) · <a title="Creative Commons (表示)" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a></p>

      <p><a href="/feed" type="application/rss+xml">RSS</a> (<a href="/blog/feed" type="application/rss+xml">雑多な記録だけのRSS</a>)</p>

      <p><a href="#top"><span aria-hidden="true">↑ </span>一番上</a></p>
    </footer>
  </body>
</html>
