<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>color-mix()関数での割合</title>

    <link title="ウェブサイト全体のRSS" href="/feed" rel="alternate" type="application/rss+xml">
    <link title="雑多な記録だけのRSS" href="/blog/feed" rel="alternate" type="application/rss+xml">
    <link href="mailto:hail2u@gmail.com" rel="author">
    <link href="https://hail2u.net/blog/percentage-in-color-mix-function.html" rel="canonical">
    <meta content="color-mix()関数をよく使うようになりつつある。ウェブ・アプリ・オア・ダイみたいな生息地なので、ネイティブ・アプリとの相互運用性に主眼を置いたデザイン・トークンが不要になり、思う存分CSSに寄せられる。カラー・パレットの管理もそうで、color-mix()関数はバリエーションを作る時に役に立つ。割合で混ぜるだけだが、仕様をしっかりと読んでおかないと思ってもみない結果になることがある。" name="description">
    <link href="/favicon.svg" rel="icon" type="image/svg+xml">
    <link href="https://creativecommons.org/licenses/by/4.0/" rel="license">
    <link href="https://m.media-amazon.com/" rel="preconnect">
    <link href="https://duckduckgo.com/?q=site%3Ahail2u.net" rel="search">

    <link href="/css/print.css?v=9.34.15" media="only print" rel="stylesheet">
    <link href="/css/index.css?v=9.34.15" media="only screen" rel="stylesheet">
  </head>

  <body>

      <nav id="top">
        <p class="back"><a href="/"><span role="img" aria-label="ホームへ戻る">←</span></a></p>
      </nav>

      <header class="page-header">
          <p class="date"><time datetime="2025-05-07T13:40:55+09:00">2025年5月7日</time></p>

        <h1><em>color-mix()関数での割合</em></h1>
      </header>

    <main>
      <p><code>color-mix()</code>関数をよく使うようになりつつある。ウェブ・アプリ・オア・ダイみたいな生息地なので、ネイティブ・アプリとの相互運用性に主眼を置いたデザイン・トークンが不要になり、思う存分CSSに寄せられる。カラー・パレットの管理もそうで、<code>color-mix()</code>関数はバリエーションを作る時に役に立つ。割合で混ぜるだけだが、仕様をしっかりと読んでおかないと思ってもみない結果になることがある。</p>

<p><code>color-mix()</code>関数は、</p>

<ul>
  <li>指定した色空間で</li>
  <li>2つの色を</li>
  <li>指定した割合で</li>
</ul>

<p>混ぜる、という関数だ。例えば、HSL色空間で、<code>red</code>と<code>blue</code>を、25%と75%ずつ混ぜてみる。<code>red</code>と<code>blue</code>は、共に彩度100%、輝度50%なので、色相だけが混ざる。以下、コード例で<code>color-mix()</code>関数を使って実行結果を表示しているが、フィード・リーダーなどでは見えないかもしれないため、別に<a href="/pub/test/714.html">テスト・ページ</a>も作っておいた。</p>

<pre><code class="language-css">.test1 {
  background-color: <span style="background-color: color-mix(in hsl, red 25%, blue 75%); color: white">color-mix(in hsl, red 25%, blue 75%)</span>;
}</code></pre>

<p><code>hsl(270deg 100% 50%)</code>、つまりブドウ色になる。片方の色で割合を省略した場合、100%から引いた値に自動的に決まるので、以下のようにも書ける。</p>

<pre><code class="language-css">.test2 {
  background-color: <span style="background-color: color-mix(in hsl, red 25%, blue); color: white">color-mix(in hsl, red 25%, blue)</span>;
}

.test3 {
  background-color: <span style="background-color: color-mix(in hsl, red, blue 75%); color: white">color-mix(in hsl, red, blue 75%)</span>;
}</code></pre>

<p>どちらも同じくブドウ色だ。割合の合計が100%を超えると、100%になるように調整されるので、以下のようにも書ける。</p>

<pre><code class="language-css">.test4 {
  background-color: <span style="background-color: color-mix(in hsl, red 30%, blue 90%); color: white">color-mix(in hsl, red 30%, blue 90%)</span>;
}</code></pre>

<p>これも同じくブドウ色だ。ただし、どちらかで100%を超える割合を指定すると無効な値になるので、以下のようには<em>書けない</em>。</p>

<pre><code class="language-css">.test5 {
  background-color: <span style="background-color: color-mix(in hsl, red 50%, blue 150%); color: black">color-mix(in hsl, red 50%, blue 150%)</span>;
}</code></pre>

<p>無効な値になり、プロパティーは無視される。割合を<code>calc()</code>関数で計算する場合に超えやすいが、安全のため<code>min()</code>関数で括るという対処方法はある。問題は割合の合計が100%に満たない場合だ。以下のように書いてみると、わかりやすいだろう。</p>

<pre><code class="language-css">.test6 {
  background-color: <span style="background-color: color-mix(in hsl, red 10%, blue 30%); color: black">color-mix(in hsl, red 10%, blue 30%)</span>;
}</code></pre>

<p>かなり薄いブドウ色になってしまう。正確にはブドウ色の透過色になっていることが開発者ツールで確認できるだろう。合計が100%に満たない場合、その合計を<em>不透明度として保持した上</em>で、合計が100%になるように調整される。つまりこの場合は<code>10% + 30% = 40%</code>が不透明度になり、結果<code>hsl(270deg 100% 50% / 40%)</code>となるわけだ。</p>

<pre><code class="language-css">.test7 {
  background-color: <span style="background-color: hsl(from color-mix(in hsl, red, blue 75%) h s l / 40%); color: black">hsl(from color-mix(in hsl, red, blue 75%) h s l / 40%);</span>
}</code></pre>

<p>不透明度もまとめて生成可能という6番目の書き方は役に立つ可能性があるが、不透明度自体は意識せざるを得ない。それならば、このように明示的に入れ子にした方がわかりやすいのではないかと思う。</p>

<p><code>color-mix()</code>関数の書き方を総括すると、どちらかで割合を指定するだけで十分ということがわかる。むしろ片方は書かない方が、うっかり間違えないので無難だろう。また、2番目の色に割合を指定すると、「色Aに色Bをn%の割合で混ぜる」と解釈でき、読みやすいのではないかと思う。いずれにしても片方だけに書くという書き方に統一することが望ましいと考えている。</p>

<hr>

<p>色の混ざり具合そのものは色空間の指定による影響が大きい。使い始めた当初はその事ばかりを意識していたが、すぐに割合の値でも大きな違いが表れることに気付く。同じような色を様々な形で作り出す修行が欠かせない。</p>
    </main>

    <footer class="page-footer">

        <p>このウェブサイトは<a href="mailto:hail2u@gmail.com">ながしまきょう</a>が<a title="Creative Commons (表示)" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a>の下で作成、公開、そして更新しています。更新情報は<a href="/feed" type="application/rss+xml">RSS</a> (<a href="/blog/feed" type="application/rss+xml">雑多な記録だけのRSS</a>)で購読できます。その他、わからないことは<a href="/#about">もう少し詳しい情報</a>を参照してください。</p>

      <p><a href="#top"><span aria-hidden="true">↑ </span>一番上</a></p>
    </footer>
  </body>
</html>
