<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="light dark" name="color-scheme">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>画像の縦横サイズの追加</title>

    <style>
      body {
        font-family: sans-serif;
        font-size: 112.5%;
        margin-block-end: 25svh;
      }

      pre {
        white-space: pre-wrap;
      }

      figure {
        margin-inline: 0;
      }

      img,
      svg {
        block-size: auto;
        max-inline-size: 100%;
      }
    </style>
  </head>

  <body>
    <p><time>2017-12-01</time></p>

    <h1>画像の縦横サイズの追加</h1>

    <p><code>img</code>要素へ画像の縦横サイズを付け直した。数年ごとに付けたり消したりしている。付けたり消したり。</p>

<p>HTTPヘッダーで使用する画像の最初の100バイトくらいだけを一気に送り付けられたりすると、ユーザー・エージェントがそれを使ってレイアウトをはじき出せそうなどということを考えている。しかしないものはないのでおとなしく付け直した。</p>

<p>付け直しはほぼ機械作業で行った。ついでに古いAmazon画像のHTTPS化も少し進めたが完全ではない。ローカルの画像は普通に読んで<code>image-size</code>パッケージで縦横サイズを取得、属性として付加する。リモートの画像はちゃんとやると面倒なので、まず画像のリストを作成し、curlで一時ディレクトリーに保存、ローカルの画像と同じように処理、という3段階に分けて行った。</p>

<hr>

<p>画像のサイズを書くのはマークアップではない、単なる作業という気がして嫌いだ。<code>p</code>要素に例えば文字数を示す属性を書く作業に近いと勝手に考えている。</p>
  </body>
</html>
