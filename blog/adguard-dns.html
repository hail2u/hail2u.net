<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta content="light dark" name="color-scheme">
    <meta content="same-origin" name="view-transition">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <title>AdGuard DNS</title>

    <style>
      body {
        font-family: sans-serif;
        font-size: 112.5%;
        margin-block-end: 25svh;
      }

      pre {
        white-space: pre-wrap;
      }

      figure {
        margin-inline: 0;
      }

      img,
      svg {
        block-size: auto;
        max-inline-size: 100%;
      }
    </style>
  </head>

  <body>
    <p><time>2019-08-28</time></p>

    <h1>AdGuard DNS</h1>

    <p>Pixel 3aにapkでインストールする<a href="https://adguard.com/ja/adguard-android/overview.html">AdGuard for Android</a>(なんちゃってVPNとして動く方)をちょっと入れてた。うまく動いているようだった。ただ、Android 9だとプライベートDNSとして<a href="https://en.wikipedia.org/wiki/DNS_over_TLS">DNS over TLS</a>が設定できる。これで<a href="https://adguard.com/ja/adguard-dns/overview.html">AdGuard DNS</a>を使うと面倒くさくない。</p>

<p>Android 9のプライベートDNSは、システム全体での設定になっている。そのためモバイル回線でのウェブページの閲覧にはもちろん、アプリの通信にも(ほとんどが)AdGuard DNSが使われる。なんちゃってVPNとして動くものをapkでインストールするより安心だったり、Wi-Fiでしか行えないDNS設定より広くカバーしてくれたり、ブラウザーでしか動かないコンテンツ・ブロッカーとは違ったりするわけだ。</p>

<p>DNSだけでのブロックなので、スマフォ自体が遅くなりにくい上、ウェブページの表示が速くなりやすい。また、これのせいでウェブページがうまく動かなくなることもほとんどない。対してファースト・パーティーのうっとうしい何かにはなすすべがない。uBlock Originなどと比較すると、機能性は1/3くらいだろう。</p>

<p>何か不都合があって無効にしたい場合は、プライベートDNSの設定を自動に戻すかOFFにする。DoTのドメイン名は記憶されているので、再び有効にするのも簡単だ。あまり不都合に気づかないが、何か変だな……と思ったら切ってみるとうまく動いたりする。ドコモのSPモード認証は切らないと通らなかった。</p>

<hr>

<p>Windows 10では<a href="https://simplednscrypt.org/">Simple DNSCrypt</a>から<a href="https://ja.wikipedia.org/wiki/Domain_Name_System#DNS_over_HTTPS_(DoH)">DNS over HTTPS</a>のみでAdGuard DNSのみを使ってみている。Simple DNSCryptはDNSサーバーのローカル・プロクシ―として動く。Simple DNSCryptを設定したら、ネットワーク・アダプターのDNSを127.0.0.1と::1だけにしておくだけだ。</p>

<p>DoTを使いたい場合は、同じようにローカルで動く<a href="https://github.com/getdnsapi/stubby">Stubby</a>くらいしかないようだ。こっちはまだ試していない。</p>
  </body>
</html>
