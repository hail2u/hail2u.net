VBScriptでMSN Messengerの表示アイコンを変更する

<p>簡単なアプリケーションやなんかでMSN Messengerの表示アイコンをサクサク変更できたら楽しーなーとか思って、いろいろ漁ったところ、チラホラ「出来る！」とか「こんな感じ！」とかいうページを見かけたのでゴニョゴニョしてみた。VBScriptでやったら3行とか言う。</p>

<p>コードは、</p>

<pre><code class="language-vb">
Dim objMessenger

Set objMessenger = WScript.CreateObject(&quot;Messenger.UIAutomation.1&quot;)
objMessenger.MyProperty(2) = &quot;C:\path\to\image.jpg&quot;
</code></pre>

<p>これだけ！これだけで指定した画像に挿し変わる。</p>

<p><a href="http://www.foobar2000.org/" title="foobar2000">foobar2000</a>では<a href="http://amip.tools-for.net/wiki/" title="What is AMIP [AMIP now playing]">AMIP</a>をうまく使えば演奏中の曲のジャケット画像を表示アイコンに使用するとかいうことも出来そう。今から作るんだけど。ちなみにfoobar2000には<a href="http://www.hydrogenaudio.org/forums/index.php?showtopic=45771&amp;st=75&amp;p=408405&amp;#entry408405" title="album art msn dp changer. - Hydrogenaudio Forums">foo_uie_albumart_msn</a>とかいうcomponentもある(v0.9.x用)。</p>

<p><a href="http://promotion.live.jp/messenger/" title="Windows Live - Windows Live メッセンジャー">Live Messenger</a>ではどうやるの？とかインストールしてないので知りません。</p>

<h2>追記</h2>

<p>15分くらいで、foobar2000で演奏中の曲を含むCDのジャケット画像を表示アイコンにするスクリプトは完成。やっぱりAMIP使ってます。以下、わかりにくい画像。</p>

<figure><a href="/images/blog/msn_dp_l.png" title="MSN Messengerの表示アイコンをfoobar2000の再生に合わせてダイナミックに変更したところ"><img src="/images/blog/msn_dp_s.png" alt="MSN Messengerの表示アイコンをfoobar2000の再生に合わせてダイナミックに変更したところ"></a></figure>

<p>fraudulence&#64;hotmail.comをMSN Messengerに登録して眺めてればたまに変わるはず。</p>
