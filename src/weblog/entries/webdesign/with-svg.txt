透過PNGをSVGを利用して軽くするテクニック

<figure>
  <a href="http://peterhrynkow.com/how-to-compress-a-png-like-a-jpeg/"><img src="/images/blog/with-svg.png" alt=""></a>
</figure>

<p>透過PNGは現状では唯一に近いフルカラーの透過画像を作成する手段だが、ファイル・サイズが大きくなりがちだ。対してJPGはファイル・サイズという点で大きく優るが、透過することは出来ない。このあちらを立てればこちらが立たずの問題を<a href="http://peterhrynkow.com/how-to-compress-a-png-like-a-jpeg/">SVGのマスク機能を使って透過だけを受け持つPNGとJPGを組み合わせることで両立させるテクニック</a>を知った。</p>

<p>透過させた画像をまず普通に作る。それから透過してないJPG画像と、透過を反転させてマスクに使うPNG画像を生成する。それらをHTMLでSVGの<code>mask</code>要素をインラインに書くことで組み合わせる。ベースとなるJPG画像が一般的にファイル・サイズに優れ、マスクに使うPNGは空白が多いこと、SVGの記述はごく短いもの、というわけで最終的に低ファイル・サイズが実現できる。</p>

<p>SVGのセキュリティ上の制限により、HTMLにインラインで記述するケースでしか使えないのでCSSの背景画像などでは利用できない。他にHTTPリクエストがひとつ増えるとかIE8で動かないなどの欠点はあるものの、フルカラーを維持したまま低ファイル・サイズで透過させるテクニックとしてはかなり優秀で、積極的に使いたい。</p>
