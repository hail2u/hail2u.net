縮小したら文字が大きく

<p><a href="http://trentwalton.com/2012/01/11/vertical-media-queries-wide-sites/">スクリーンサイズに応じたフォントサイズの変更</a>はかなり読みやすくなるアイディアだと思っていて、ここでもずいぶん前から使っている。が、ブラウザーのズームと相性が非常に悪く、縮小したつもりが文字サイズが大きくなったみたいなことがよく起こる。このウェブサイトでもネタ元のウェブサイトでも起こる。</p>

<p>最初はMedia Queriesのブレークポイントで<code>em</code>単位を使うとおかしくなるのかと思ってて、その気になればすぐ直せると思ってたけど全然違った。ズーム機能によって閲覧領域自体が仮想的に変化するということが原因だった。</p>

<p>以下の様な簡単なフォントサイズ調節CSSを例にする。数字にはあんまり意味はない。</p>

<pre><code class="language-css">@media (min-width: 960px) {
  html {
    font-size: 20px;
  }
}
</code></pre>

<p>このCSSが指定されているHTMLページを<code>900px</code>の幅で開いてからズームで90%に縮小するケースを考えると、閲覧領域が<code>1000px</code> (<code>900px * 10 / 9</code>)に拡大されるので、ブレークポイントを超え、フォントサイズが<code>20px</code>になる。つまり<em>ズームで縮小したのにもかかわらず文字サイズは拡大される</em>という非常に違和感のある結果になってしまう。</p>

<p>対処法を色々考えていて、デバイスやブラウザーで固有だったり固定されたりしない媒体特性(media features)ではない<code>resolution</code>を使うとうまくいきそうな気配がある。</p>

<pre><code class="language-css">@media (min-width: 960px) and (resolution: 96dpi) {
  html {
    font-size: 20px;
  }
}
</code></pre>

<p>Windowsのデフォルトでは<code>96dpi</code>だけどズームによってその値は変化するので、こうするとズーム機能が初期状態でない場合は基本フォントサイズの変更が起きなくなる(Windows上のFirefox 21でうまく機能する)。ズーム機能使う人には余計なお世話っぽいので提供しなくて良さそうと考えると、この方向性は間違ってないような気はする。しかし星の数ほどある<code>resolution</code>の値に対応して実装するのはちょっと無理があるので、うまい方法を考えている。</p>

<p>……無さそうだ。</p>
