git grepをVimで使う

<p>Gitの<code>grep</code>サブコマンドは通常Gitリポジトリーでしか使えない。しかし<code>--no-index</code>オプションを付けると、Gitリポジトリーではないディレクトリーでも検索できる（もちろんGitリポジトリーでも）。Vimからももちろん使えるので、<a href="http://beyondgrep.com/">ack</a>ちょっと遅い、<a href="http://geoff.greer.fm/ag/">ag</a>入れるのが面倒くさい、MSYS上で使ってると<a href="https://github.com/mattn/jvgrep">jvgrep</a>の出力が稀におかしい、などの理由でgrepに戻ったりしてる人は<code>git grep</code>を使うのも良さそう。</p>

<pre><code class="language-vim">set grepprg=git\ grep\ --no-index\ -I\ --line-number
</code></pre>

<p><code>grepformat</code>を編集しないで済ませるためには<code>--line-number</code>オプションを追加して、行番号を表示させる必要がある。僕はバイナリ・ファイルを無視する<code>-I</code>オプションも合わせて追加しておいた。パフォーマンスをあげるために<code>--no-color</code>オプションを付けるのも良さそう。</p>

<hr>

<p>Gitの<code>grep</code>サブコマンドだと、グロブの指定をせずにデフォルトで再帰的に下層ディレクトリーを検索してくれるのも楽。検索対象を絞りたい場合はglob(7)に従った形で指定したり、<code>--max-depth</code>オプションを追加して制限したりするだけなので、わかりにくいということはなさそう。agのオプションは覚えられる気しないけど、これなら大丈夫っぽい。</p>
